<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ—à–∏—Ñ—Ä–∞—Ç–æ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0f0c29;
            color: #fff;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .controls {
            border-bottom: 2px solid #333;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            color: #00ff88;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff88;
        }

        .upload-area {
            border: 3px dashed #00ff88;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            background: rgba(0, 255, 136, 0.05);
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-area:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: #00ff99;
        }

        .upload-area h3 {
            color: #00ff88;
            margin-bottom: 10px;
        }

        textarea {
            width: 100%;
            height: 200px;
            background: #1a1a2e;
            color: #00ff88;
            border: 2px solid #333;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-bottom: 20px;
            resize: vertical;
        }

        button {
            background: linear-gradient(90deg, #00ff88, #00cc66);
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button.secondary {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
        }

        .results {
            display: none;
            margin-top: 30px;
            border-top: 2px solid #333;
            padding-top: 20px;
        }

        .data-section {
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .section-title {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-row {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #2a2a3e;
        }

        .data-row:last-child {
            border-bottom: none;
        }

        .data-label {
            color: #8899aa;
            font-weight: bold;
        }

        .map-link {
            color: #66aaff;
            text-decoration: none;
        }

        .map-link:hover {
            text-decoration: underline;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 1em;
            color: #00ff88;
            font-weight: bold;
        }

        .stat-label {
            color: #8899aa;
            font-size: 0.9em;
        }

        .json-viewer {
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            max-height: 500px;
            overflow: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #00ff88;
        }

        pre {
            white-space: pre-wrap;
        }

        .tabs {
            display: flex;
            gap: 10px;
        }

        .tab {
            padding: 10px 20px;
            background: #2a2a3e;
            border: none;
            color: #8899aa;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
        }

        .tab.active {
            background: #00ff88;
            color: #000;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="upload-area" id="dropArea">
            <h3>–ó–ê–ì–†–£–ó–ò–¢–ï –î–ê–ù–ù–´–ï</h3>
            <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ JSON —Ñ–∞–π–ª –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∏–∂–µ</p>
            <input type="file" id="fileInput" accept=".json,.txt" style="display: none;">
        </div>

        <textarea id="jsonInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ —Å—é–¥–∞..."></textarea>

        <div class="controls">
            <div>
                <button onclick="decodeData()">–†–ê–°–®–ò–§–†–û–í–ö–ê</button>
                <button class="secondary" onclick="clearAll()">–û–ß–ò–°–¢–ò–¢–¨</button>
                <button class="secondary" onclick="exportReport()">–≠–ö–°–ü–û–†–¢ –û–¢–ß–ï–¢–ê</button>
            </div>

            <div class="tabs" id="tabs">
                <button class="tab active" onclick="switchTab('stats', this)">–°–¢–ê–¢–ò–°–¢–ò–ö–ê</button>
                <button class="tab" onclick="switchTab('details', this)">–î–ï–¢–ê–õ–ò</button>
                <button class="tab" onclick="switchTab('raw', this)">RAW JSON</button>
                <button class="tab" onclick="switchTab('map', this)">–ö–ê–†–¢–ê</button>
            </div>
        </div>

        <div class="results" id="results">
            <div id="statsTab" class="tab-content">
                <div class="stats" id="stats"></div>
            </div>

            <div id="detailsTab" class="tab-content" style="display: none;">
                <div id="details"></div>
            </div>

            <div id="rawTab" class="tab-content" style="display: none;">
                <div class="json-viewer">
                    <pre id="rawJson"></pre>
                </div>
            </div>

            <div id="mapTab" class="tab-content" style="display: none;">
                <div id="mapContainer"
                    style="max-height: 700px; background: #1a1a2e; border-radius: 8px; padding: 20px;">
                    <p>–ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç</p>
                    <div id="map" style="height: 100%;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const jsonInput = document.getElementById('jsonInput');
        const results = document.getElementById('results');
        const tabs = document.querySelectorAll('.tab');

        dropArea.addEventListener('click', () => fileInput.click());

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.style.background = 'rgba(0, 255, 136, 0.15)';
            dropArea.style.borderColor = '#00ff99';
        }

        function unhighlight() {
            dropArea.style.background = '';
            dropArea.style.borderColor = '';
        }

        dropArea.addEventListener('drop', handleDrop, false);
        fileInput.addEventListener('change', handleFileSelect, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            if (files.length === 0) return;

            const file = files[0];
            const reader = new FileReader();

            reader.onload = function (e) {
                jsonInput.value = e.target.result;
                decodeData();
            };

            reader.readAsText(file);
        }

        function decodeData() {
            try {
                const input = jsonInput.value.trim();
                if (!input) {
                    alert('–í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ!');
                    return;
                }

                let jsonData = extractJsonFromEmail(input);

                const data = JSON.parse(jsonData);

                displayResults(data);
                results.style.display = 'block';

                results.scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: ' + error.message);
                console.error(error);
            }
        }

        function extractJsonFromEmail(text) {
            const jsonMatch = text.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                return jsonMatch[0];
            }

            if (text.startsWith('{')) {
                return text;
            }

            const lines = text.split('\n');
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].trim().startsWith('{')) {
                    return lines.slice(i).join('\n');
                }
            }

            throw new Error('JSON –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–µ–∫—Å—Ç–µ');
        }

        function displayResults(data) {
            displayStats(data);
            displayDetails(data);
            displayRawJson(data);
            displayMap(data);
        }

        function displayStats(data) {
            const statsContainer = document.getElementById('stats');

            const stats = [
                {
                    label: 'IP –ê–î–†–ï–°',
                    value: data.location?.details?.ipBased?.ip ? `<span title="–ü–æ–ª–Ω—ã–π IP">${data.location.details.ipBased.ip}</span>` : '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω',
                    color: '#ff9966'
                },
                {
                    label: '–ì–ï–û–õ–û–ö–ê–¶–ò–Ø',
                    value: data.capabilities?.apis?.geolocation ? '–î–æ—Å—Ç—É–ø–Ω–∞' : '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞',
                    color: data.capabilities?.apis?.geolocation ? '#00ff88' : '#ff6666'
                },
                {
                    label: '–¢–û–ß–ù–û–°–¢–¨',
                    value: getGeoAccuracySimple(data),
                    color: getGeoAccuracyColorSimple(data)
                },
                {
                    label: '–ë–†–ê–£–ó–ï–†',
                    value: `${data.browser?.name || ''} ${data.browser?.version ? 'v' + data.browser.version : ''}`.trim(),
                    color: '#00ff88'
                },
                {
                    label: '–¢–ò–ü –û–°',
                    value: data.browser?.platform || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω',
                    color: '#667eea'
                },
                {
                    label: '–¢–ò–ü –£–°–¢–†–û–ô–°–¢–í–ê',
                    value: getDeviceType(data),
                    color: getDeviceColor(data)
                },
                {
                    label: '–ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ô',
                    value: data.projectData?.switchCount || '0',
                    color: '#ff66aa'
                },
                {
                    label: '–ß–ê–°–û–í–û–ô –ü–û–Ø–°',
                    value: data.system?.time?.timezone ?
                        data.system.time.timezone.replace('_', ' ') : '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω',
                    color: '#ffcc00'
                },
                {
                    label: '–ó–ê–î–ï–†–ñ–ö–ê',
                    value: data.network?.rtt ? `${typeof data.network.rtt === 'number' ? data.network.rtt : parseInt(data.network.rtt) || 0} ms` : '–ù–µ –∏–∑–≤–µ—Å—Ç–Ω–∞',
                    color: data.network?.rtt < 100 ? '#00ff88' : data.network?.rtt < 300 ? '#ffcc00' : '#ff6666'
                },
                {
                    label: '–Ø–ó–´–ö/–Ø–ó–´–ö–ò',
                    value: data.browser?.languages?.length ? `${data.browser.language} + ${data.browser.languages.length - 1}` : data.browser?.language || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω',
                    color: '#aa66ff'
                },
                {
                    label: 'BLUETOOTH',
                    value: data.bluetooth?.available ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞',
                    color: data.bluetooth?.available ? '#00ff88' : '#ff5555'
                },
                {
                    label: 'USB',
                    value: data.capabilities?.apis?.usb ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞',
                    color: data.capabilities?.apis?.usb ? '#00ff88' : '#ff5555'
                }
            ];

            statsContainer.innerHTML = stats.map(stat => `
            <div class="stat-box">
                <div class="stat-value" style="color: ${stat.color}">${stat.value}</div>
                <div class="stat-label">${stat.label}</div>
            </div>
            `).join('');
        }

        function displayDetails(data) {
            const detailsContainer = document.getElementById('details');

            const sections = [
                {
                    title: '–ú–ï–¢–ê-–ò–ù–§–û–†–ú–ê–¶–ò–Ø',
                    data: [
                        ['–í—Ä–µ–º—è —Å–±–æ—Ä–∞', formatDate(data.meta?.collectedAt)],
                        ['–ò—Å—Ç–æ—á–Ω–∏–∫', data.meta?.source || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–ü—Ä–æ–µ–∫—Ç', data.projectData?.project || '–°–ï–¢–¨'],
                        ['–¢—Ä–∏–≥–≥–µ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–∏', data.projectData?.activationTrigger || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ']
                    ]
                },
                {
                    title: '–ë–†–ê–£–ó–ï–†',
                    data: [
                        ['–ë—Ä–∞—É–∑–µ—Ä', getBrowserEngine(data)],
                        ['User Agent', `<small>${data.browser?.userAgent?.substring(0, 80)}...</small>`],
                        ['–Ø–∑—ã–∫', data.browser?.language || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏', data.browser?.languages?.join(', ') || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã'],
                        ['–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞', data.browser?.platform || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–ö—É–∫–∏', formatCookies(data.browser?.cookieEnabled)],
                        ['User Agent –¥–ª–∏–Ω–∞', `${data.browser?.userAgentLength || 0} —Å–∏–º–≤–æ–ª–æ–≤`],
                        ['–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', getDeviceType(data)]
                    ]
                },
                {
                    title: '–°–ò–°–¢–ï–ú–ê',
                    data: [
                        ['–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ, px', `${data.system?.screen?.width || 0} √ó ${data.system?.screen?.height || 0}`],
                        ['–¶–≤–µ—Ç–Ω–æ—Å—Ç—å', `${data.system?.screen?.colorDepth || 0} –±–∏—Ç`],
                        ['–ü–∏–∫—Å–µ–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ', data.system?.window?.devicePixelRatio || '1'],
                        ['–Ø–¥—Ä–∞ CPU', data.system?.hardware?.hardwareConcurrency || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'],
                        ['–ü–∞–º—è—Ç—å', data.system?.hardware?.deviceMemory ? `${data.system.hardware.deviceMemory} GB` : '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'],
                        ['–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å', data.system?.time?.timezone || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–°–µ–Ω—Å–æ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω', formatBoolean(data.system?.hardware?.hasTouchScreen, '–î–∞', '–ù–µ—Ç')],
                        ['–¶–≤–µ—Ç–æ–≤–æ–π –æ—Ö–≤–∞—Ç', data.system?.screen?.colorGamut || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'],
                        ['HDR', formatBoolean(data.system?.screen?.hdr, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è')]
                    ]
                },
                {
                    title: '–ú–ï–°–¢–û–ü–û–õ–û–ñ–ï–ù–ò–ï',
                    data: [
                        ['IP –∞–¥—Ä–µ—Å', `<span class="data-value ip">${data.location?.details?.ipBased?.ip || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}</span>`],
                        ['–ê–Ω–∞–ª–∏–∑ IP-–∞–¥—Ä–µ—Å–∞', getIPAnalysisDisplay(data)],
                        ['–°—Ç—Ä–∞–Ω–∞', data.location?.details?.ipBased?.country || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞'],
                        ['–ì–æ—Ä–æ–¥', data.location?.details?.ipBased?.city || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–ü—Ä–æ–≤–∞–π–¥–µ—Ä', data.location?.details?.ipBased?.org || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–¢–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã', getPreciseLocation(data)]
                    ]
                },
                {
                    title: '–°–ï–¢–¨',
                    data: [
                        ['–°—Ç–∞—Ç—É—Å', formatNetworkStatus(data.network?.online)],
                        ['–¢–∏–ø —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è', data.network?.connectionType || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Ç–∏–ø', data.network?.effectiveType || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'],
                        ['–°–∫–æ—Ä–æ—Å—Ç—å', data.network?.downlink ? `${data.network.downlink} Mbps` : '–ù–µ –∏–∑–≤–µ—Å—Ç–Ω–∞'],
                        ['–ó–∞–¥–µ—Ä–∂–∫–∞', data.network?.rtt ? `${data.network.rtt} ms` : '–ù–µ –∏–∑–≤–µ—Å—Ç–Ω–∞'],
                        ['–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞', formatSaveData(data.network?.saveData)],
                        ['API –æ–±–Ω–∞—Ä—É–∂–µ–Ω', data.network?.detectedAPI || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'],
                        ['–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', formatBoolean(data.network?.supported, '–î–∞', '–ù–µ—Ç')]
                    ]
                },
                {
                    title: '–í–û–ó–ú–û–ñ–ù–û–°–¢–ò',
                    data: [
                        ['–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è', formatBoolean(data.capabilities?.apis?.geolocation, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['–ö–∞–º–µ—Ä–∞/–ú–∏–∫—Ä–æ—Ñ–æ–Ω', formatBoolean(data.capabilities?.apis?.mediaDevices, '–î–æ—Å—Ç—É–ø–Ω–∞/–¥–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', formatBoolean(data.capabilities?.apis?.notifications, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è')],
                        ['–ë—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', formatBoolean(data.capabilities?.apis?.clipboard, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['WebGL', formatBoolean(data.capabilities?.apis?.webGL, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è <small>(3D –≥—Ä–∞—Ñ–∏–∫–∞)</small>', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è')],
                        ['Service Workers', formatBoolean(data.capabilities?.apis?.serviceWorker, '–î–æ—Å—Ç—É–ø–Ω—ã <small>(–æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º)</small>', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['Bluetooth', formatBoolean(data.capabilities?.apis?.bluetooth, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['USB', formatBoolean(data.capabilities?.apis?.usb, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['WebXR (VR/AR)', formatBoolean(data.capabilities?.apis?.webXR, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')]
                    ]
                },
                {
                    title: '–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û',
                    data: [
                        ['–ö—É–∫–∏', formatBoolean(data.capabilities?.storage?.cookies, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è')],
                        ['LocalStorage', formatBoolean(data.capabilities?.storage?.localStorage, '–î–æ—Å—Ç—É–ø–Ω–æ', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['SessionStorage', formatBoolean(data.capabilities?.storage?.sessionStorage, '–î–æ—Å—Ç—É–ø–Ω–æ', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['IndexedDB', formatBoolean(data.capabilities?.storage?.indexedDB, '–î–æ—Å—Ç—É–ø–Ω–∞ <small>(–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)</small>', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['–ü–ª–∞–≥–∏–Ω—ã', data.additional?.plugins?.length ? `${data.additional.plugins.length} —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ` : '–ù–µ—Ç –ø–ª–∞–≥–∏–Ω–æ–≤']
                    ]
                },
                {
                    title: '–†–ê–°–®–ò–†–ï–ù–ù–´–ï',
                    data: [
                        ['WebAuthn API', getWebAuthnDetails(data.advanced?.webAuthn)],
                        ['Share API', getShareAPIDetails(data.advanced?.shareAPI)],
                        ['WebRTC', getWebRTCDetails(data.advanced?.webRTC)],
                        ['Payment API', getPaymentAPIDetails(data.advanced?.paymentAPI)],
                        ['Credentials API', getCredentialsAPIDetails(data.advanced?.credentialsAPI)],
                        ['Battery API', getBatteryDetails(data.advanced?.battery)],
                        ['Fonts API', getFontsInfoDisplay(data)],
                        ['MIME Types', getMimeTypesDisplay(data)],
                        ['WebGL', getWebGLInfoDisplay(data)]
                    ]
                },
                {
                    title: '–ü–û–í–ï–î–ï–ù–ò–ï',
                    data: [
                        ['–ì–ª—É–±–∏–Ω–∞ —Å–∫—Ä–æ–ª–ª–∞', data.behavior?.scrollDepth || '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'],
                        ['–í—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ', data.behavior?.timeOnPage || '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'],
                        ['–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞', data.behavior?.screenOrientation || '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'],
                        ['–í–∏–¥–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã', data.behavior?.visibilityState || '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'],
                        ['–§–æ–∫—É—Å –æ–∫–Ω–∞', data.behavior?.hasFocus ? '–í —Ñ–æ–∫—É—Å–µ' : '–ù–µ –≤ —Ñ–æ–∫—É—Å–µ']
                    ]
                },
                {
                    title: '–•–†–ê–ù–ò–õ–ò–©–ê',
                    data: [
                        ['LocalStorage', getLocalStorageDetails(data)],
                        ['SessionStorage', data.storage?.sessionStorage?.available ? `<span style="color:#00ff88">‚óè –î–æ—Å—Ç—É–ø–Ω–æ: </span> ${data.storage.sessionStorage.count || 0} –∑–∞–ø–∏—Å–µ–π` : formatBoolean(false, '–î–æ—Å—Ç—É–ø–Ω–æ', '–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ')],
                        ['IndexedDB', data.storage?.indexedDB?.available ? `<span style="color:#00ff88">‚óè –î–æ—Å—Ç—É–ø–Ω–æ: </span> ${data.storage.indexedDB.databases?.length || 0} –±–∞–∑` : formatBoolean(false, '–î–æ—Å—Ç—É–ø–Ω–æ', '–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ')],
                        ['Cookies', getDetailedCookiesDisplay(data)],
                        ['WebSQL', getWebSQLStatus(data)],
                        ['Cache API', getCacheAPIInfo(data)]
                    ]
                },
                {
                    title: '–î–ê–¢–ß–ò–ö–ò',
                    data: [
                        ['–ì–∏—Ä–æ—Å–∫–æ–ø', formatBoolean(data.sensors?.gyroscope, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä', formatBoolean(data.sensors?.accelerometer, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–î–∞—Ç—á–∏–∫ –æ—Å–≤–µ—â–µ–Ω–∏—è', formatBoolean(data.sensors?.ambientLight, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–î–∞—Ç—á–∏–∫ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è', formatBoolean(data.sensors?.proximity, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–î–∞—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è', formatBoolean(data.sensors?.deviceMotion, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è', formatBoolean(data.sensors?.deviceOrientation, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–ú–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä', formatBoolean(data.sensors?.magnetometer, '–ï—Å—Ç—å', '–ù–µ—Ç')]
                    ]
                },
                {
                    title: 'BLUETOOTH –£–°–¢–†–û–ô–°–¢–í–ê',
                    data: [
                        ['–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API', formatBoolean(data.bluetooth?.available, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['–î–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–∏—Å—Ç–µ–º–µ', formatBoolean(data.bluetooth?.details?.isAvailable, '–î–∞', '–ù–µ—Ç')],
                        ['–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ', data.bluetooth?.details?.permissions || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'],
                        ['–°–æ–ø—Ä—è–∂–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', data.bluetooth?.details?.pairedDevicesCount || 0],
                        ['–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è', formatBoolean(data.bluetooth?.details?.canScan, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', getBluetoothDevicesDisplay(data.bluetooth?.devices)]
                    ]
                },
                {
                    title: 'USB –£–°–¢–†–û–ô–°–¢–í–ê',
                    data: [
                        ['–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API', formatBoolean(data.usb?.available, '–î–æ—Å—Ç—É–ø–µ–Ω', '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞')],
                        ['–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ', data.usb?.details?.permissionState || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'],
                        ['–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', data.usb?.details?.connectedDevicesCount || 0],
                        ['–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', getUSBDevicesDisplay(data.usb?.devices)]
                    ]
                },
                {
                    title: '–ö–ê–ú–ï–†–ê –ò –ú–ò–ö–†–û–§–û–ù',
                    data: [
                        ['–í—Å–µ–≥–æ –∫–∞–º–µ—Ä', data.media?.details?.summary?.cameraCount || 0],
                        ['–í—Å–µ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–≤', data.media?.details?.summary?.microphoneCount || 0],
                        ['–§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞', formatBoolean(data.media?.details?.systemInfo?.hasFrontCamera, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–¢—ã–ª–æ–≤–∞—è –∫–∞–º–µ—Ä–∞', formatBoolean(data.media?.details?.systemInfo?.hasBackCamera, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–í–Ω–µ—à–Ω—è—è –∫–∞–º–µ—Ä–∞', formatBoolean(data.media?.details?.systemInfo?.hasExternalCamera, '–ï—Å—Ç—å', '–ù–µ—Ç')],
                        ['–ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞', formatBoolean(data.media?.details?.screen?.hasScreenCapture, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è')],
                        ['–î–µ—Ç–∞–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤', getMediaDevicesDisplay(data.media?.details?.devices)]
                    ]
                },
                {
                    title: '–ü–†–ò–í–ê–¢–ù–û–°–¢–¨ –ò –ó–ê–©–ò–¢–ê',
                    data: [
                        ['–§–ª–∞–≥–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏', getPrivacyFlagsDisplay(data)],
                        ['–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ API', getBlockedAPIsDisplay(data)],
                        ['–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—É–∫–∏', getCookieSettingsDisplay(data)],
                        ['–ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏–Ω–≥–µ—Ä–ø—Ä–∏–Ω—Ç–∏–Ω–≥–∞', getFingerprintingProtectionDisplay(data)],
                        ['–ë–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–∏ —Ä–µ–∫–ª–∞–º—ã', getAdBlockersDisplay(data)],
                        ['–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞', getBrowserVulnerabilitiesDisplay(data)],
                        ['Security Headers', getSecurityHeadersDisplay(data)],
                        ['WebGL —É—è–∑–≤–∏–º–æ—Å—Ç–∏', getWebGLVulnerabilitiesDisplay(data)],
                        ['CORS –ø—Ä–æ–±–ª–µ–º—ã', getCorsIssuesDisplay(data)]
                    ]
                },
                {
                    title: '–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø',
                    data: [
                        ['In-App –ë—Ä–∞—É–∑–µ—Ä—ã', getInAppBrowsersDisplay(data)],
                        ['–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã', getSocialWidgetsDisplay(data)],
                        ['–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ª–æ–≥–∏–Ω—ã', getSavedLoginsDisplay(data)],
                        ['OAuth —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã', getOAuthRedirectsDisplay(data)],
                        ['–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö', getSocialMediaPresenceDisplay(data)],
                        ['–ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ', getBrowserHabitsDisplay(data)],
                        ['–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º', getDeviceInteractionDisplay(data)]
                    ]
                },
                {
                    title: '–ü–õ–ê–¢–ï–ñ–ò –ò –ê–í–¢–û–ó–ê–ü–û–õ–ù–ï–ù–ò–ï',
                    data: [
                        ['–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å', getPaymentSummaryDisplay(data)],
                        ['–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ', getAutofillDisplay(data)],
                        ['–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã', getPaymentSystemsDisplay(data)],
                        ['–ë–∏–æ–º–µ—Ç—Ä–∏—è/–∫–ª—é—á–∏', getWebAuthnDisplay(data)]
                    ]
                }
            ];

            detailsContainer.innerHTML = sections.map(section => `
                <div class="data-section">
                    <div class="section-title">
                        <span>${section.title}</span>
                    </div>
                    ${section.data.map(([label, value]) => `
                        <div class="data-row">
                            <div class="data-label">${label}</div>
                            <div class="data-value">${value}</div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        function displayRawJson(data) {
            document.getElementById('rawJson').textContent =
                JSON.stringify(data, null, 2);
        }

        function displayMap(data) {
            const mapContainer = document.getElementById('mapContainer');

            if (data.location?.details?.precise?.latitude && data.location?.details?.precise?.longitude) {
                const lat = data.location.details.precise.latitude;
                const lon = data.location.details.precise.longitude;
                const accuracy = data.location.details.precise.accuracy || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';

                mapContainer.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong> ${lat}, ${lon}<br>
                        <strong>–¢–æ—á–Ω–æ—Å—Ç—å:</strong> ${accuracy}<br>
                        <a href="https://www.openstreetmap.org/?mlat=${lat}&mlon=${lon}&zoom=16" 
                           target="_blank" class="map-link">
                            üîó –û—Ç–∫—Ä—ã—Ç—å –≤ OpenStreetMap
                        </a> | 
                        <a href="https://maps.google.com/?q=${lat},${lon}" 
                           target="_blank" class="map-link">
                            üîó –û—Ç–∫—Ä—ã—Ç—å –≤ Google Maps
                        </a>
                    </div>
                    <iframe 
                        width="100%" 
                        height="450" 
                        frameborder="0" 
                        scrolling="no" 
                        marginheight="0" 
                        marginwidth="0" 
                        src="https://www.openstreetmap.org/export/embed.html?bbox=${lon - 0.01}%2C${lat - 0.01}%2C${lon + 0.01}%2C${lat + 0.01}&layer=mapnik&marker=${lat}%2C${lon}">
                    </iframe>
                `;
            } else if (data.location?.details?.ipBased?.latitude && data.location?.details?.ipBased?.longitude) {
                const lat = data.location.details.ipBased.latitude;
                const lon = data.location.details.ipBased.longitude;

                mapContainer.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>–ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ IP:</strong> ${lat}, ${lon}<br>
                        <strong>–¢–æ—á–Ω–æ—Å—Ç—å:</strong> –ù–∏–∑–∫–∞—è (–ø–æ IP)<br>
                        <a href="https://www.openstreetmap.org/?mlat=${lat}&mlon=${lon}&zoom=12" 
                           target="_blank" class="map-link">
                            üîó –û—Ç–∫—Ä—ã—Ç—å –≤ OpenStreetMap
                        </a>
                    </div>
                    <iframe 
                        width="100%" 
                        height="450" 
                        frameborder="0" 
                        scrolling="no" 
                        marginheight="0" 
                        marginwidth="0" 
                        src="https://www.openstreetmap.org/export/embed.html?bbox=${lon - 0.05}%2C${lat - 0.05}%2C${lon + 0.05}%2C${lat + 0.05}&layer=mapnik&marker=${lat}%2C${lon}">
                    </iframe>
                `;
            } else {
                mapContainer.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <p style="color: #8899aa; font-size: 1.2em;">
                            üó∫Ô∏è –ì–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç<br>
                            <small>–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç—ã –Ω—É–∂–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</small>
                        </p>
                    </div>
                `;
            }
        }

        function getWebSQLStatus(data) {
            let webSQL = data.capabilities?.misc?.webSQL;

            if (webSQL && typeof webSQL === 'object') {
                webSQL = webSQL.available;
            }

            if (webSQL === undefined) {
                webSQL = data.advanced?.webSQL;
                if (webSQL && typeof webSQL === 'object') {
                    webSQL = webSQL.available;
                }
            }

            if (webSQL === undefined) {
                webSQL = data.storage?.webSQL?.available;
            }

            return formatBoolean(webSQL, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
        }

        function getCacheAPIInfo(data) {
            const cacheAPI = data.advanced?.cacheAPI || data.storage?.cacheAPI;

            if (!cacheAPI || !cacheAPI.available) {
                return '<span style="color:#ff5555">‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</span>';
            }

            const count = cacheAPI.count || cacheAPI.caches?.length || 0;
            return `${count} –∫—ç—à–µ–π`;
        }

        function formatDate(isoString) {
            if (!isoString) return '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ';
            return new Date(isoString).toLocaleString('ru-RU');
        }

        function formatNetworkStatus(online) {
            return online ?
                '<span style="color:#00ff88">‚óè –û–Ω–ª–∞–π–Ω</span>' :
                '<span style="color:#ff5555">‚óè –û—Ñ—Ñ–ª–∞–π–Ω</span>';
        }

        function formatCookies(enabled) {
            return enabled ?
                '<span style="color:#00ff88">‚óè –í–∫–ª—é—á–µ–Ω—ã</span>' :
                '<span style="color:#ff5555">‚óè –í—ã–∫–ª—é—á–µ–Ω—ã</span>';
        }

        function formatSaveData(saveData) {
            return saveData ?
                '<span style="color:#ffaa00">‚óè –í–∫–ª—é—á–µ–Ω–∞</span>' :
                '<span style="color:#ff5555">‚óè –í—ã–∫–ª—é—á–µ–Ω–∞</span>';
        }

        function formatBoolean(value, trueText, falseText) {
            if (value === undefined || value === null) {
                return '<span style="color:#ff5555">‚óè undefined</span>';
            }

            if (value === true || value === 'true') {
                return `<span style="color:#00ff88">‚óè ${trueText}</span>`;
            } else if (value === false || value === 'false') {
                return `<span style="color:#ff5555">‚óè ${falseText}</span>`;
            }
            return `<span style="color:#8899aa">‚óè –ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ</span>`;
        }

        function getDeviceType(data) {
            const width = data.system?.screen?.width;
            const isMobile = data.browser?.isMobile;
            const isTablet = data.browser?.isTablet;

            if (!width) return '<span style="color:#8899aa">–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ</span>';

            if (width < 768) return 'üì± –ú–æ–±–∏–ª—å–Ω–æ–µ';
            if (width < 992) return 'üìü –ü–ª–∞–Ω—à–µ—Ç';
            if (width < 1200) return 'üíª –ù–æ—É—Ç–±—É–∫';
            return 'üñ•Ô∏è –î–µ—Å–∫—Ç–æ–ø';
        }

        function getDeviceColor(data) {
            const width = data.system?.screen?.width;
            if (!width) return '#8899aa';

            if (width < 768) return '#ff66aa';
            if (width < 1024) return '#ff9966';
            if (width < 1440) return '#667eea';
            if (width < 2560) return '#00ff88';
            return '#ffcc00';
        }

        function getGeoAccuracySimple(data) {
            if (data.location?.details?.precise?.latitude) {
                const acc = data.location.details.precise.accuracy || '';
                if (acc.includes('–º–µ—Ç—Ä')) {
                    const meters = parseInt(acc) || 1000;
                    if (meters < 100) return '–¢–æ—á–Ω–∞—è';
                    if (meters < 500) return '–•–æ—Ä–æ—à–∞—è';
                }
                return '–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è';
            }

            if (data.location?.details?.ipBased?.country_name) {
                return '–ü–æ IP';
            }

            if (data.location?.details?.ipBased?.ip) {
                return '–¢–æ–ª—å–∫–æ IP';
            }

            return '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
        }

        function getGeoAccuracyColorSimple(data) {
            const acc = getGeoAccuracySimple(data);
            if (acc.includes('–¢–æ—á–Ω–∞—è')) return '#00ff88';
            if (acc.includes('–•–æ—Ä–æ—à–∞—è')) return '#66ffcc';
            if (acc.includes('–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è')) return '#ffcc00';
            if (acc.includes('–ü–æ IP')) return '#ff9966';
            if (acc.includes('–¢–æ–ª—å–∫–æ IP')) return '#8899aa';
            return '#ff6666';
        }

        function getPreciseLocation(data) {
            if (data.location?.details?.precise?.latitude) {
                const lat = data.location.details.precise.latitude;
                const lon = data.location.details.precise.longitude;
                const acc = data.location.details.precise.accuracy || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';

                return `
            <div style="margin-top: 5px;">
                <span class="data-value coords" style="color:#00ff88; font-weight: bold;">${lat}, ${lon}</span><br>
                <small style="color:#8899aa;">–¢–æ—á–Ω–æ—Å—Ç—å: ${acc}</small><br>
                <div style="margin-top: 5px;">
                    <a href="https://maps.google.com/?q=${lat},${lon}" 
                       target="_blank" 
                       class="map-link"
                       style="display: inline-block; padding: 4px 8px; background: rgba(0,100,255,0.1); border-radius: 4px; margin-right: 5px;">
                        üîó Google Maps
                    </a>
                    <a href="https://www.openstreetmap.org/?mlat=${lat}&mlon=${lon}&zoom=16" 
                       target="_blank" 
                       class="map-link"
                       style="display: inline-block; padding: 4px 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
                        üîó OpenStreetMap
                    </a>
                </div>
            </div>
        `;
            }
            return '<span class="data-value warning" style="color:#ff5555;">‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏</span>';
        }

        function getFontsInfoDisplay(data) {
            if (!data.advanced?.fonts?.available) {
                return '<span style="color:#8899aa">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</span>';
            }

            const fonts = data.advanced.fonts;
            if (fonts.sample && fonts.sample.length > 0) {
                const sampleText = fonts.sample.slice(0, 3).join(', ');
                const moreText = fonts.count > 3 ? ` (+${fonts.count - 3})` : '';
                return `${fonts.uniqueCount} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö${moreText}<br><small>${sampleText}</small>`;
            }

            return `${fonts.uniqueCount || fonts.count || 0} —à—Ä–∏—Ñ—Ç–æ–≤`;
        }

        function getMimeTypesDisplay(data) {
            const mimeTypes = data.advanced?.mimeTypes || data.capabilities?.mimeTypes || data.additional?.mimeTypes;

            if (!mimeTypes || !mimeTypes.available) {
                return '<span style="color:#8899aa">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</span>';
            }

            const count = mimeTypes.count || 0;

            if (mimeTypes.types && mimeTypes.types.length > 0) {
                const sampleTypes = mimeTypes.types.slice(0, 3).map(t =>
                    typeof t === 'object' ? t.type : t
                );
                const sampleText = sampleTypes.join(', ');
                const moreText = count > 3 ? ` (+${count - 3})` : '';
                return `${count} —Ç–∏–ø–æ–≤${moreText}<br><small>${sampleText}</small>`;
            }

            return `${count} —Ç–∏–ø–æ–≤`;
        }

        function getWebGLInfoDisplay(data) {
            if (!data.capabilities?.apis?.webGL) {
                return '<span style="color:#ff5555">‚óè –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';
            }

            const webglInfo = data.capabilities.webGL;
            if (webglInfo) {
                let info = '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';
                if (webglInfo.vendor || webglInfo.renderer) {
                    info += '<br><small>';
                    if (webglInfo.vendor) info += `–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å: ${webglInfo.vendor.substring(0, 30)}...<br>`;
                    if (webglInfo.renderer) info += `–†–µ–Ω–¥–µ—Ä–µ—Ä: ${webglInfo.renderer.substring(0, 30)}...<br>`;
                    if (webglInfo.supportedExtensions) info += `–†–∞—Å—à–∏—Ä–µ–Ω–∏–π: ${webglInfo.supportedExtensions}`;
                    info += '</small>';
                }
                return info;
            }

            return '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';
        }

        function getBluetoothDevicesDisplay(bluetoothDevices) {
            if (!bluetoothDevices || bluetoothDevices.length === 0) {
                return '<span style="color:#8899aa">–ù–µ—Ç —Å–æ–ø—Ä—è–∂–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</span>';
            }

            const list = bluetoothDevices.map(device =>
                `<div style="margin: 5px 0; padding: 5px; background: rgba(0,100,255,0.1); border-radius: 4px;">
            <strong>${device.name}</strong><br>
            <small>ID: ${device.id}</small>
            ${device.gattConnected ? '<small style="color:#00ff88;"> ‚óè –ü–æ–¥–∫–ª—é—á–µ–Ω–æ</small>' : '<small style="color:#ff5555;"> ‚óè –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</small>'}
        </div>`
            ).join('');

            return `<div style="max-height: 200px; overflow-y: auto;">${list}</div>`;
        }

        function getUSBDevicesDisplay(usbDevices) {
            if (!usbDevices || usbDevices.length === 0) {
                return '<span style="color:#8899aa">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤</span>';
            }

            const list = usbDevices.map(device =>
                `<div style="margin: 5px 0; padding: 5px; background: rgba(0,200,100,0.1); border-radius: 4px;">
            <strong>${device.productName}</strong><br>
            <small>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å: ${device.manufacturerName}</small><br>
            <small>VID: 0x${device.vendorId.toString(16)}, PID: 0x${device.productId.toString(16)}</small><br>
            <small>${device.usbVersion} | –°–µ—Ä–∏–π–Ω—ã–π: ${device.serialNumber}</small>
        </div>`
            ).join('');

            return `<div style="max-height: 200px; overflow-y: auto;">${list}</div>`;
        }

        function getMediaDevicesDisplay(mediaDevices) {
            if (!mediaDevices || mediaDevices.length === 0) {
                return '<span style="color:#8899aa">–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</span>';
            }

            const cameras = mediaDevices.filter(d => d.type === 'camera');
            const microphones = mediaDevices.filter(d => d.type === 'microphone');
            const speakers = mediaDevices.filter(d => d.type === 'speaker');

            let html = `<div style="max-height: 800px; overflow-y: auto;">`;

            if (cameras.length > 0) {
                html += `<h4 style="color:#00ff88; margin-top: 10px;">–í–∏–¥–µ–æ (${cameras.length}):</h4>`;
                cameras.forEach(device => {
                    html += `<div style="margin: 5px 0; padding: 5px; background: rgba(255,100,0,0.1); border-radius: 4px;">
                <strong>${device.label}</strong>`;

                    if (device.settings) {
                        const s = device.settings;
                        html += `<br><small>${s.width}√ó${s.height}, ${s.frameRate || '?'}fps`;
                        if (s.facingMode) html += ` | ${getFacingModeText(s.facingMode)}`;
                        html += `</small>`;
                    }

                    if (device.error) {
                        html += `<br><small style="color:#ff6666;">–û—à–∏–±–∫–∞: ${device.error}</small>`;
                    }

                    html += `</div>`;
                });
            }

            if (microphones.length > 0) {
                html += `<h4 style="color:#00ff88; margin-top: 10px;">–ú–∏–∫—Ä–æ—Ñ–æ–Ω—ã (${microphones.length}):</h4>`;
                microphones.forEach(device => {
                    html += `<div style="margin: 5px 0; padding: 5px; background: rgba(0,100,255,0.1); border-radius: 4px;">
                <strong>${device.label}</strong>`;

                    if (device.settings) {
                        const s = device.settings;
                        html += `<br><small>${s.sampleRate}Hz, ${s.channelCount} –∫–∞–Ω–∞–ª–æ–≤`;
                        if (s.echoCancellation) html += ` | –®—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ`;
                        html += `</small>`;
                    }

                    html += `</div>`;
                });
            }

            if (speakers.length > 0) {
                html += `<h4 style="color:#00ff88; margin-top: 10px;">–ê—É–¥–∏–æ (${speakers.length}):</h4>`;
                speakers.forEach(device => {
                    html += `<div style="margin: 5px 0; padding: 5px; background: rgba(100,0,255,0.1); border-radius: 4px;">
                <strong>${device.label}</strong>
            </div>`;
                });
            }

            html += `</div>`;
            return html;
        }

        function getFacingModeText(mode) {
            switch (mode) {
                case 'user': return '–§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è';
                case 'environment': return '–¢—ã–ª–æ–≤–∞—è';
                default: return mode;
            }
        }

        function getLocalStorageDetails(data) {
            if (!data.storage?.localStorage?.available) {
                return '<span style="color:#ff5555">‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</span>';
            }

            const ls = data.storage.localStorage;
            const count = ls.count || 0;

            if (count === 0) {
                return '<span style="color:#8899aa">0 –∑–∞–ø–∏—Å–µ–π</span>';
            }

            let html = `<strong>${count} –∑–∞–ø–∏—Å–µ–π:</strong><br>`;
            html += `<div style="max-height: 800px; overflow-y: auto; margin-top: 5px;">`;

            if (ls.data) {
                for (const [key, value] of Object.entries(ls.data)) {
                    const displayKey = key.length > 30 ? key.substring(0, 30) + '...' : key;
                    const displayValue = value && value.length > 50 ? value.substring(0, 50) + '...' : value;

                    html += `<div style="margin: 3px 0; padding: 5px; background: rgba(0,255,136,0.1); border-radius: 5px;">
                <strong style="color:#00ff88">${displayKey}</strong><br>
                <small>${displayValue || '(–ø—É—Å—Ç–æ)'}</small>
            </div>`;
                }
            } else {
                html += '<small style="color:#ff9966">–î–∞–Ω–Ω—ã–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</small>';
            }

            html += `</div>`;
            return html;
        }

        function getWebAuthnDetails(webAuthn) {
            if (!webAuthn || webAuthn.available === false) {
                return formatBoolean(false, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
            }

            let html = '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span><br>';
            html += '<small>';

            if (webAuthn.isU2FSupported) html += 'U2F, ';
            if (webAuthn.isCTAPSupported) html += 'CTAP, ';
            if (webAuthn.isConditionalMediation) html += '–£—Å–ª–æ–≤–Ω–∞—è –º–µ–¥–∏–∞—Ü–∏—è, ';
            if (webAuthn.isUserVerifyingPlatformAuthenticatorAvailable) html += '–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä';

            html += '</small>';
            return html;
        }

        function getShareAPIDetails(shareAPI) {
            if (!shareAPI || shareAPI.available === false) {
                return formatBoolean(false, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
            }

            let html = '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';

            if (shareAPI.canShare !== undefined) {
                html += `<br><small>canShare: ${formatBoolean(shareAPI.canShare, '–î–∞', '–ù–µ—Ç')}`;
                if (shareAPI.canShareFiles !== undefined) {
                    html += `, –§–∞–π–ª—ã: ${formatBoolean(shareAPI.canShareFiles, '–î–∞', '–ù–µ—Ç')}`;
                }
                html += '</small>';
            }

            return html;
        }

        function getWebRTCDetails(webRTC) {
            if (!webRTC || webRTC.available === false) {
                return formatBoolean(false, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
            }

            let html = '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';

            if (webRTC.codecs) {
                const audioCodecs = webRTC.codecs.audio?.length || 0;
                const videoCodecs = webRTC.codecs.video?.length || 0;
                html += `<br><small>–ö–æ–¥–µ–∫–∏: ${audioCodecs} –∞—É–¥–∏–æ, ${videoCodecs} –≤–∏–¥–µ–æ</small>`;
            }

            if (webRTC.stunServers > 0 || webRTC.turnServers > 0) {
                html += `<br><small>–°–µ—Ä–≤–µ—Ä—ã: ${webRTC.stunServers || 0} STUN, ${webRTC.turnServers || 0} TURN</small>`;
            }

            return html;
        }

        function getPaymentAPIDetails(paymentAPI) {
            if (!paymentAPI || paymentAPI.available === false) {
                return formatBoolean(false, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
            }

            let html = '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';

            if (paymentAPI.supportedMethods && paymentAPI.supportedMethods.length > 0) {
                html += `<br><small>–ú–µ—Ç–æ–¥—ã: ${paymentAPI.supportedMethods.length}</small>`;
            }

            return html;
        }

        function getCredentialsAPIDetails(credentialsAPI) {
            if (!credentialsAPI || credentialsAPI.available === false) {
                return formatBoolean(false, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
            }

            let html = '<span style="color:#00ff88">‚óè –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</span>';

            if (credentialsAPI.types) {
                const supportedTypes = [];
                if (credentialsAPI.types.password) supportedTypes.push('–ü–∞—Ä–æ–ª–∏');
                if (credentialsAPI.types.federated) supportedTypes.push('–§–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ');
                if (credentialsAPI.types.publicKey) supportedTypes.push('–ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏');

                if (supportedTypes.length > 0) {
                    html += `<br><small>–¢–∏–ø—ã: ${supportedTypes.join(', ')}</small>`;
                }
            }

            return html;
        }

        function getBatteryDetails(battery) {
            if (!battery || battery.available === false) {
                return formatBoolean(false, '–î–æ—Å—Ç—É–ø–Ω–æ', '–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ');
            }

            return `${battery.level} (–∑–∞—Ä—è–¥–∫–∞: ${formatBoolean(battery.charging, '–î–∞', '–ù–µ—Ç')})`;
        }

        function getIPAnalysisDisplay(data) {
            const analysis = data.location?.details?.ipAnalysis;

            if (!analysis) {
                return '<span style="color:#8899aa">–ê–Ω–∞–ª–∏–∑ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω</span>';
            }

            let html = `
        <div style="
            margin-top: 10px;
            padding: 15px;
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 8px;
            max-height: 800px;
            overflow-y: auto;
        ">
    `;

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: rgba(0, 255, 136, 0.1); border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:#00ff88; font-weight: bold;">–ö–ª–∞—Å—Å —Å–µ—Ç–∏</span>
                <span style="color:${getClassColor(analysis.class)}; font-weight: bold; font-family: monospace;">
                    ${analysis.class || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}
                </span>
            </div>
        </div>
    `;

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: rgba(0, 100, 255, 0.1); border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:#00ccff; font-weight: bold;">–¢–∏–ø IP</span>
                <span style="color:${getTypeColor(analysis.type)}; font-family: monospace;">
                    ${analysis.type || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}
                </span>
            </div>
        </div>
    `;

            if (analysis.special && !analysis.special.includes('Regular')) {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(255, 100, 0, 0.1); border-radius: 4px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color:#ff9966; font-weight: bold;">–û—Å–æ–±—ã–π –∞–¥—Ä–µ—Å</span>
                    <span style="color:#ff9966; font-family: monospace;">
                        ${analysis.special}
                    </span>
                </div>
            </div>
        `;
            }

            if (analysis.subnet && analysis.subnet.mask !== 'N/A') {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(255, 255, 0, 0.1); border-radius: 4px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color:#ffcc00; font-weight: bold;">–ü–æ–¥—Å–µ—Ç—å</span>
                    <span style="color:#ffcc00; font-family: monospace;">
                        –ú–∞—Å–∫–∞: ${analysis.subnet.mask} ${analysis.subnet.cidr}
                    </span>
                </div>
                <div style="margin-top: 5px; font-size: 0.9em; color:#8899aa;">
                    –•–æ—Å—Ç–æ–≤: ${analysis.subnet.hosts}
                </div>
            </div>
        `;
            }

            if (analysis.octets) {
                html += `
            <div style="margin-bottom: 10px;">
                <div style="color:#00ff88; font-weight: bold; margin-bottom: 8px;">–û–∫—Ç–µ—Ç—ã:</div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; text-align: center;">
                    ${[1, 2, 3, 4].map(i => `
                        <div style="padding: 8px; background: rgba(0, 255, 136, 0.1); border-radius: 4px;">
                            <div style="color:#00ff88; font-size: 1.2em; font-weight: bold; font-family: monospace;">
                                ${analysis.octets[['first', 'second', 'third', 'fourth'][i - 1]]}
                            </div>
                            <div style="font-size: 0.8em; color:#8899aa; margin-top: 3px;">
                                ${i}-–π –æ–∫—Ç–µ—Ç
                            </div>
                        </div>
                    `).join('')}
                </div>
                ${analysis.octets.networkPart && analysis.octets.hostPart ? `
                    <div style="margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div style="padding: 8px; background: rgba(0, 200, 255, 0.1); border-radius: 4px;">
                            <div style="font-size: 0.9em; color:#00ccff;">–°–µ—Ç–µ–≤–∞—è —á–∞—Å—Ç—å</div>
                            <div style="color:#00ccff; font-weight: bold; font-family: monospace;">
                                ${analysis.octets.networkPart}
                            </div>
                        </div>
                        <div style="padding: 8px; background: rgba(255, 100, 0, 0.1); border-radius: 4px;">
                            <div style="font-size: 0.9em; color:#ff9966;">–•–æ—Å—Ç–æ–≤–∞—è —á–∞—Å—Ç—å</div>
                            <div style="color:#ff9966; font-weight: bold; font-family: monospace;">
                                ${analysis.octets.hostPart}
                            </div>
                        </div>
                    </div>
                ` : ''}
            </div>
        `;
            }

            if (analysis.binary && analysis.hexadecimal) {
                html += `
            <div style="margin-bottom: 10px;">
                <div style="color:#00ff88; font-weight: bold; margin-bottom: 8px;">–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:</div>
                <div style="display: grid; grid-template-columns: 1fr; gap: 8px;">
                    <div style="padding: 8px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; font-family: monospace;">
                        <div style="font-size: 0.9em; color:#8899aa; margin-bottom: 3px;">–ë–∏–Ω–∞—Ä–Ω—ã–π</div>
                        <div style="color:#00ff88; word-break: break-all;">
                            ${analysis.binary}
                        </div>
                    </div>
                    <div style="padding: 8px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; font-family: monospace;">
                        <div style="font-size: 0.9em; color:#8899aa; margin-bottom: 3px;">–®–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–π</div>
                        <div style="color:#00ff88;">
                            ${analysis.hexadecimal}
                        </div>
                    </div>
                </div>
            </div>
        `;
            }

            const classInfo = getClassInfo(analysis.class);
            if (classInfo) {
                html += `
            <div style="margin-top: 15px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 6px; border-left: 3px solid ${getClassColor(analysis.class)};">
                <div style="color:${getClassColor(analysis.class)}; font-weight: bold; margin-bottom: 5px;">
                    –ö–ª–∞—Å—Å ${analysis.class}: ${classInfo.name}
                </div>
                <div style="font-size: 0.9em; color:#8899aa; line-height: 1.4;">
                    ${classInfo.description}
                </div>
            </div>
        `;
            }

            html += `</div>`;
            return html;
        }


        function getClassColor(ipClass) {
            const colors = {
                'A': '#00ff88',
                'B': '#00ccff',
                'C': '#ff9966',
                'D (multicast)': '#ff66aa',
                'E (experimental)': '#aa66ff'
            };
            return colors[ipClass] || '#8899aa';
        }

        function getTypeColor(ipType) {
            if (!ipType) return '#8899aa';

            if (ipType.includes('public')) return '#00ff88';
            if (ipType.includes('private')) return '#ff9966';
            if (ipType.includes('loopback')) return '#ff66aa';
            if (ipType.includes('multicast')) return '#aa66ff';
            if (ipType.includes('link-local')) return '#ffcc00';
            if (ipType.includes('reserved')) return '#ff5555';

            return '#8899aa';
        }

        function getClassInfo(ipClass) {
            const info = {
                'A': {
                    name: '–ö—Ä—É–ø–Ω—ã–µ —Å–µ—Ç–∏',
                    description: '–î–ª—è –æ—á–µ–Ω—å –∫—Ä—É–ø–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π. –ü–µ—Ä–≤—ã–π –æ–∫—Ç–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–µ—Ç—å, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–∏ - —Ö–æ—Å—Ç—ã. –î–∏–∞–ø–∞–∑–æ–Ω: 1.0.0.1 - 126.255.255.254'
                },
                'B': {
                    name: '–°—Ä–µ–¥–Ω–∏–µ —Å–µ—Ç–∏',
                    description: '–î–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –∏ –∫—Ä—É–ø–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π. –ü–µ—Ä–≤—ã–µ –¥–≤–∞ –æ–∫—Ç–µ—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Å–µ—Ç—å, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–≤–∞ - —Ö–æ—Å—Ç—ã. –î–∏–∞–ø–∞–∑–æ–Ω: 128.0.0.1 - 191.255.255.254'
                },
                'C': {
                    name: '–ú–∞–ª—ã–µ —Å–µ—Ç–∏',
                    description: '–î–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π. –ü–µ—Ä–≤—ã–µ —Ç—Ä–∏ –æ–∫—Ç–µ—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Å–µ—Ç—å, –ø–æ—Å–ª–µ–¥–Ω–∏–π - —Ö–æ—Å—Ç—ã. –î–∏–∞–ø–∞–∑–æ–Ω: 192.0.0.1 - 223.255.255.254'
                },
                'D (multicast)': {
                    name: 'Multicast',
                    description: '–î–ª—è –º–Ω–æ–≥–æ–∞–¥—Ä–µ—Å–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ (multicast). –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—ã—á–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –î–∏–∞–ø–∞–∑–æ–Ω: 224.0.0.0 - 239.255.255.255'
                },
                'E (experimental)': {
                    name: '–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π',
                    description: '–ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤. –î–∏–∞–ø–∞–∑–æ–Ω: 240.0.0.0 - 255.255.255.254'
                }
            };

            return info[ipClass];
        }

        function getPrivacyFlagsDisplay(data) {
            const privacy = data.privacy?.details?.privacyFlags;
            if (!privacy) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 400px; overflow-y: auto;">';

            const flags = [
                { name: 'Do Not Track', value: privacy.doNotTrack, color: privacy.doNotTrack === '1' ? '#00ff88' : '#ff5555' },
                { name: 'Global Privacy Control', value: privacy.globalPrivacyControl ? '–í–∫–ª—é—á–µ–Ω' : '–í—ã–∫–ª—é—á–µ–Ω', color: privacy.globalPrivacyControl ? '#00ff88' : '#ff5555' },
                { name: 'Cookies', value: privacy.cookieEnabled ? '–†–∞–∑—Ä–µ—à–µ–Ω—ã' : '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã', color: privacy.cookieEnabled ? '#00ff88' : '#ff5555' },
                { name: '–°–Ω–∏–∂–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è', value: privacy.reducedMotion ? '–í–∫–ª—é—á–µ–Ω–æ' : '–í—ã–∫–ª—é—á–µ–Ω–æ', color: privacy.reducedMotion ? '#00ff88' : '#8899aa' },
                { name: '–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å', value: privacy.contrast === 'high' ? '–í—ã—Å–æ–∫–∞—è' : privacy.contrast === 'low' ? '–ù–∏–∑–∫–∞—è' : '–ù–æ—Ä–º–∞–ª—å–Ω–∞—è', color: privacy.contrast === 'high' ? '#00ff88' : '#8899aa' }
            ];

            flags.forEach(flag => {
                html += `
            <div style="display: flex; justify-content: space-between; margin: 5px 0; padding: 5px; background: rgba(0,0,0,0.1); border-radius: 3px;">
                <span style="color:#cccccc;">${flag.name}</span>
                <span style="color:${flag.color}; font-weight: bold;">${flag.value}</span>
            </div>
        `;
            });

            html += '</div>';
            return html;
        }

        function getBlockedAPIsDisplay(data) {
            const blocked = data.privacy?.details?.blockedAPIs;
            if (!blocked) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 200px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${blocked.blockedCount > 0 ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between;">
                <span style="color:${blocked.blockedCount > 0 ? '#ff9966' : '#00ff88'}">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ API:</span>
                <span style="color:${blocked.blockedCount > 0 ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${blocked.blockedCount} –∏–∑ ${blocked.totalChecked}
                </span>
            </div>
        </div>
    `;

            if (blocked.blockedAPIs && blocked.blockedAPIs.length > 0) {
                html += '<div style="margin-top: 10px;">';
                blocked.blockedAPIs.forEach(api => {
                    html += `
                <div style="margin: 3px 0; padding: 4px 8px; background: rgba(255,100,0,0.1); border-radius: 3px;">
                    <span style="color:#ff9966;">‚óè ${api}</span>
                </div>
            `;
                });
                html += '</div>';
            } else {
                html += `
            <div style="text-align: center; padding: 10px; color:#00ff88;">
                ‚úì –í—Å–µ API –¥–æ—Å—Ç—É–ø–Ω—ã
            </div>
        `;
            }

            html += '</div>';
            return html;
        }

        function getCookieSettingsDisplay(data) {
            const cookies = data.privacy?.details?.cookieSettings;
            if (!cookies) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 400px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
            <div style="padding: 8px; background: ${cookies.hasCookies ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
                <div style="color:${cookies.hasCookies ? '#00ff88' : '#ff5555'}; font-size: 0.9em;">Cookies</div>
                <div style="color:${cookies.hasCookies ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${cookies.hasCookies ? '‚úì –î–æ—Å—Ç—É–ø–Ω—ã' : '‚úó –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã'}
                </div>
            </div>
            
            <div style="padding: 8px; background: ${cookies.thirdPartyCookies ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
                <div style="color:${cookies.thirdPartyCookies ? '#00ff88' : '#ff5555'}; font-size: 0.9em;">Third-party</div>
                <div style="color:${cookies.thirdPartyCookies ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${cookies.thirdPartyCookies === 'allowed' ? '‚úì –†–∞–∑—Ä–µ—à–µ–Ω—ã' :
                    cookies.thirdPartyCookies === 'blocked' ? '‚úó –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã' : '? –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
                </div>
            </div>
        </div>
    `;

            if (cookies.storageAPIs) {
                html += '<div style="margin-top: 10px; color:#cccccc; font-size: 0.9em;">Storage APIs:</div>';
                html += '<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-top: 5px;">';

                const apis = [
                    { name: 'LocalStorage', key: 'localStorage' },
                    { name: 'SessionStorage', key: 'sessionStorage' },
                    { name: 'IndexedDB', key: 'indexedDB' },
                    { name: 'Cache API', key: 'caches' },
                    { name: 'ServiceWorker', key: 'serviceWorker' }
                ];

                apis.forEach(api => {
                    const isAvailable = cookies.storageAPIs[api.key];
                    html += `
                <div style="padding: 5px; background: ${isAvailable ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 3px; text-align: center;">
                    <div style="color:${isAvailable ? '#00ff88' : '#ff5555'}; font-size: 0.8em;">${api.name}</div>
                    <div style="color:${isAvailable ? '#00ff88' : '#ff5555'}; font-size: 0.7em;">
                        ${isAvailable ? '‚úì' : '‚úó'}
                    </div>
                </div>
            `;
                });

                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        function getFingerprintingProtectionDisplay(data) {
            const protection = data.privacy?.details?.fingerprintingProtection;
            if (!protection) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            if (protection.braveShields?.isBrave) {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(255, 200, 0, 0.1); border-radius: 4px; border-left: 3px solid #ffc800;">
                <div style="color:#ffc800; font-weight: bold;">Brave Shields</div>
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">
                    Brave –±—Ä–∞—É–∑–µ—Ä —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
                </div>
            </div>
        `;
            }

            if (protection.firefoxTrackingProtection?.isFirefox && protection.firefoxTrackingProtection.trackingProtection) {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(255, 100, 0, 0.1); border-radius: 4px; border-left: 3px solid #ff6400;">
                <div style="color:#ff6400; font-weight: bold;">Firefox Tracking Protection</div>
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">
                    –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω–∞ (v${protection.firefoxTrackingProtection.version})
                </div>
            </div>
        `;
            }

            if (protection.safariITP?.isSafari && protection.safariITP.itpEnabled) {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(0, 100, 255, 0.1); border-radius: 4px; border-left: 3px solid #0064ff;">
                <div style="color:#0064ff; font-weight: bold;">Safari ITP</div>
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">
                    Intelligent Tracking Prevention –≤–∫–ª—é—á–µ–Ω (v${protection.safariITP.version})
                </div>
            </div>
        `;
            }

            html += '<div style="margin-top: 15px; color:#cccccc; font-size: 0.9em;">–ú–µ—Ç–æ–¥—ã —Ñ–∏–Ω–≥–µ—Ä–ø—Ä–∏–Ω—Ç–∏–Ω–≥–∞:</div>';
            html += '<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 5px;">';

            const methods = [
                { name: 'Canvas', key: 'canvasFingerprinting' },
                { name: 'Audio', key: 'audioFingerprinting' },
                { name: 'WebGL', key: 'webglFingerprinting' }
            ];

            methods.forEach(method => {
                const status = protection[method.key];
                const isBlocked = status.includes('blocked');

                html += `
            <div style="padding: 8px; background: ${isBlocked ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
                <div style="color:${isBlocked ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${method.name}
                </div>
                <div style="color:${isBlocked ? '#00ff88' : '#ff5555'}; font-size: 0.8em; margin-top: 3px;">
                    ${isBlocked ? '‚úì –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' : '‚ö†Ô∏è –í–æ–∑–º–æ–∂–µ–Ω'}
                </div>
            </div>
        `;
            });

            html += '</div>';
            html += '</div>';
            return html;
        }

        function getAdBlockersDisplay(data) {
            const adBlockers = data.privacy?.details?.adBlockers;
            if (!adBlockers) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 800px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${adBlockers.detected ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${adBlockers.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    –ë–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫ —Ä–µ–∫–ª–∞–º—ã
                </span>
                <span style="color:${adBlockers.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${adBlockers.detected ? '–û–±–Ω–∞—Ä—É–∂–µ–Ω' : '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω'}
                </span>
            </div>
            <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ: ${adBlockers.totalTests} –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤
            </div>
        </div>
    `;

            if (adBlockers.blockers && adBlockers.blockers.length > 0) {
                html += '<div style="margin-top: 10px;">';
                html += '<div style="color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">–í–æ–∑–º–æ–∂–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–∏:</div>';

                adBlockers.blockers.forEach(blocker => {
                    html += `
                <div style="margin: 5px 0; padding: 6px; background: rgba(255,100,0,0.1); border-radius: 3px;">
                    <div style="color:#ff9966; font-weight: bold;">${blocker.name}</div>
                    <div style="color:#8899aa; font-size: 0.8em;">${blocker.reason}</div>
                </div>
            `;
                });

                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        function getBrowserVulnerabilitiesDisplay(data) {
            const vulns = data.privacy?.details?.browserVulnerabilities;
            if (!vulns) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${vulns.isSecure ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${vulns.isSecure ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${vulns.browser} ${vulns.version}
                </span>
                <span style="color:${vulns.isSecure ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${vulns.isSecure ? '–ë–µ–∑–æ–ø–∞—Å–µ–Ω' : `${vulns.vulnerabilityCount} —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π`}
                </span>
            </div>
        </div>
    `;

            if (vulns.vulnerabilities && vulns.vulnerabilities.length > 0) {
                html += '<div style="margin-top: 10px;">';

                vulns.vulnerabilities.forEach(vuln => {
                    const severityColor =
                        vuln.severity === 'critical' ? '#ff5555' :
                            vuln.severity === 'high' ? '#ff9966' :
                                vuln.severity === 'medium' ? '#ffcc00' : '#8899aa';

                    html += `
                <div style="margin: 8px 0; padding: 8px; background: rgba(255,100,0,0.1); border-radius: 4px; border-left: 3px solid ${severityColor};">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color:${severityColor}; font-weight: bold;">${vuln.type}</span>
                        <span style="color:${severityColor}; font-size: 0.8em; text-transform: uppercase;">${vuln.severity}</span>
                    </div>
                    <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">${vuln.message}</div>
                </div>
            `;
                });

                html += '</div>';
            } else {
                html += `
            <div style="text-align: center; padding: 15px; color:#00ff88;">
                ‚úì –ë—Ä–∞—É–∑–µ—Ä –∞–∫—Ç—É–∞–ª–µ–Ω –∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω
            </div>
        `;
            }

            html += '</div>';
            return html;
        }

        function getSecurityHeadersDisplay(data) {
            const headers = data.privacy?.details?.securityHeaders;
            if (!headers) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            const headerInfo = [
                { name: 'CSP', key: 'csp', description: 'Content Security Policy' },
                { name: 'HSTS', key: 'hsts', description: 'HTTP Strict Transport Security' },
                { name: 'X-Frame-Options', key: 'xFrameOptions', description: '–ó–∞—â–∏—Ç–∞ –æ—Ç clickjacking' },
                { name: 'X-Content-Type-Options', key: 'xContentTypeOptions', description: 'MIME sniffing protection' },
                { name: 'X-XSS-Protection', key: 'xXSSProtection', description: 'Prevents some of XSS attacks' },
                { name: 'Referrer-Policy', key: 'referrerPolicy', description: '–ö–æ–Ω—Ç—Ä–æ–ª—å referrer' },
                { name: 'Permissions-Policy', key: 'permissionsPolicy', description: 'Controlling browser features' }
            ];

            let html = '<div style="max-height: 800px; overflow-y: auto;">';

            headerInfo.forEach(header => {
                const isPresent = headers[header.key];

                html += `
            <div style="margin: 5px 0; padding: 8px; background: ${isPresent ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <span style="color:${isPresent ? '#00ff88' : '#ff5555'}; font-weight: bold;">${header.name}</span>
                        <div style="color:#8899aa; font-size: 0.8em;">${header.description}</div>
                    </div>
                    <span style="color:${isPresent ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                        ${isPresent ? '‚úì' : '‚úó'}
                    </span>
                </div>
            </div>
        `;
            });

            const presentCount = Object.values(headers).filter(h => h).length;
            const totalCount = Object.keys(headers).length;

            html += `
        <div style="margin-top: 10px; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
            <div style="display: flex; justify-content: space-between;">
                <span style="color:#00ccff;">–í—Å–µ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:</span>
                <span style="color:#00ccff; font-weight: bold;">
                    ${presentCount}/${totalCount}
                </span>
            </div>
        </div>
    `;

            html += '</div>';
            return html;
        }

        function getWebGLVulnerabilitiesDisplay(data) {
            const webgl = data.privacy?.details?.webglVulnerabilities;

            if (!webgl) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${webgl.webglAvailable ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${webgl.webglAvailable ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    WebGL
                </span>
                <span style="color:${webgl.webglAvailable ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${webgl.webglAvailable ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ –¥–æ—Å—Ç—É–ø–µ–Ω'}
                </span>
            </div>
            ${webgl.vendor && webgl.renderer ? `
                <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                    ${webgl.vendor} | ${webgl.renderer}
                </div>
            ` : ''}
        </div>
    `;

            if (webgl.vulnerabilities && webgl.vulnerabilities.length > 0) {
                html += '<div style="margin-top: 10px;">';
                html += '<div style="color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">–£—è–∑–≤–∏–º—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:</div>';

                webgl.vulnerabilities.forEach(vuln => {
                    html += `
                <div style="margin: 5px 0; padding: 6px; background: rgba(255,100,0,0.1); border-radius: 3px;">
                    <div style="color:#ff9966; font-weight: bold;">${vuln.extension}</div>
                    <div style="color:#8899aa; font-size: 0.8em;">${vuln.description}</div>
                </div>
            `;
                });

                html += '</div>';
            } else if (webgl.webglAvailable) {
                html += `
            <div style="text-align: center; padding: 15px; color:#00ff88;">
                ‚úì WebGL –±–µ–∑–æ–ø–∞—Å–µ–Ω<br>
                <small style="color:#8899aa;">–†–∞—Å—à–∏—Ä–µ–Ω–∏–π: ${webgl.extensions?.length || 0}</small>
            </div>
        `;
            }

            html += '</div>';
            return html;
        }

        function getCorsIssuesDisplay(data) {
            const cors = data.privacy?.details?.corsIssues;
            if (!cors) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${cors.hasCorsIssues ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${cors.hasCorsIssues ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    CORS (Cross-Origin Resource Sharing)
                </span>
                <span style="color:${cors.hasCorsIssues ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${cors.hasCorsIssues ? `${cors.issueCount} –ø—Ä–æ–±–ª–µ–º` : '–ù–µ—Ç –ø—Ä–æ–±–ª–µ–º'}
                </span>
            </div>
        </div>
    `;

            if (cors.issues && cors.issues.length > 0) {
                html += '<div style="margin-top: 10px;">';

                cors.issues.forEach(issue => {
                    const severityColor =
                        issue.severity === 'high' ? '#ff5555' :
                            issue.severity === 'medium' ? '#ff9966' : '#ffcc00';

                    html += `
                <div style="margin: 5px 0; padding: 6px; background: rgba(255,100,0,0.1); border-radius: 3px; border-left: 3px solid ${severityColor};">
                    <div style="color:${severityColor}; font-weight: bold;">${issue.url}</div>
                    <div style="color:#cccccc; font-size: 0.8em;">${issue.issue}</div>
                </div>
            `;
                });

                html += '</div>';
            } else {
                html += `
            <div style="text-align: center; padding: 15px; color:#00ff88;">
                CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
            </div>
        `;
            }

            html += '</div>';
            return html;
        }

        function getInAppBrowsersDisplay(data) {
            const inApp = data.userProfile?.details?.inAppBrowsers;
            if (!inApp) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 200px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${inApp.detected ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${inApp.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    In-App –ë—Ä–∞—É–∑–µ—Ä
                </span>
                <span style="color:${inApp.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${inApp.detected ? '–û–±–Ω–∞—Ä—É–∂–µ–Ω' : '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω'}
                </span>
            </div>
            ${inApp.count > 0 ? `
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">
                    –ù–∞–π–¥–µ–Ω–æ: ${inApp.count} –±—Ä–∞—É–∑–µ—Ä–æ–≤
                </div>
            ` : ''}
        </div>
    `;

            if (inApp.browsers && inApp.browsers.length > 0) {
                html += '<div style="margin-top: 10px;">';

                inApp.browsers.forEach(browser => {
                    const confidenceColor =
                        browser.confidence === 'high' ? '#ff5555' :
                            browser.confidence === 'medium' ? '#ff9966' : '#ffcc00';

                    html += `
                <div style="margin: 5px 0; padding: 6px; background: rgba(255,100,0,0.1); border-radius: 3px; border-left: 3px solid ${confidenceColor};">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color:${confidenceColor}; font-weight: bold;">${browser.name}</span>
                        <span style="color:${confidenceColor}; font-size: 0.8em;">${browser.confidence}</span>
                    </div>
                    <div style="color:#cccccc; font-size: 0.8em;">${browser.details}</div>
                </div>
            `;
                });

                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        function getSocialWidgetsDisplay(data) {
            const widgets = data.userProfile?.details?.socialWidgets;
            if (!widgets) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${widgets.detected ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${widgets.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã
                </span>
                <span style="color:${widgets.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${widgets.detected ? `${widgets.count} –Ω–∞–π–¥–µ–Ω–æ` : '–ù–µ –Ω–∞–π–¥–µ–Ω—ã'}
                </span>
            </div>
            ${widgets.detected ? `
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-top: 8px;">
                    <div style="text-align: center; padding: 4px; background: rgba(0,100,255,0.1); border-radius: 3px;">
                        <div style="color:#00ccff; font-weight: bold;">${widgets.byType?.scripts || 0}</div>
                        <div style="color:#8899aa; font-size: 0.7em;">–°–∫—Ä–∏–ø—Ç—ã</div>
                    </div>
                    <div style="text-align: center; padding: 4px; background: rgba(0,100,255,0.1); border-radius: 3px;">
                        <div style="color:#00ccff; font-weight: bold;">${widgets.byType?.iframes || 0}</div>
                        <div style="color:#8899aa; font-size: 0.7em;">Iframes</div>
                    </div>
                    <div style="text-align: center; padding: 4px; background: rgba(0,100,255,0.1); border-radius: 3px;">
                        <div style="color:#00ccff; font-weight: bold;">${widgets.byType?.widgets || 0}</div>
                        <div style="color:#8899aa; font-size: 0.7em;">–í–∏–¥–∂–µ—Ç—ã</div>
                    </div>
                </div>
            ` : ''}
        </div>
    `;

            if (widgets.widgets && widgets.widgets.length > 0) {
                html += '<div style="margin-top: 10px;">';

                const byType = {
                    script: [],
                    iframe: [],
                    widget: []
                };

                widgets.widgets.forEach(w => {
                    if (byType[w.type]) byType[w.type].push(w);
                });

                if (byType.script.length > 0) {
                    html += '<div style="color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">–°–∫—Ä–∏–ø—Ç—ã:</div>';
                    byType.script.forEach(widget => {
                        html += `
                    <div style="margin: 3px 0; padding: 5px; background: rgba(0,100,255,0.1); border-radius: 3px;">
                        <div style="color:#00ccff; font-weight: bold;">${widget.name}</div>
                        <div style="color:#8899aa; font-size: 0.8em; word-break: break-all;">${widget.url}</div>
                    </div>
                `;
                    });
                }

                if (byType.iframe.length > 0) {
                    html += '<div style="margin-top: 10px; color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">Iframes:</div>';
                    byType.iframe.forEach(widget => {
                        html += `
                    <div style="margin: 3px 0; padding: 5px; background: rgba(255,100,0,0.1); border-radius: 3px;">
                        <div style="color:#ff9966; font-weight: bold;">${widget.name}</div>
                        <div style="color:#8899aa; font-size: 0.8em; word-break: break-all;">${widget.url}</div>
                    </div>
                `;
                    });
                }

                if (byType.widget.length > 0) {
                    html += '<div style="margin-top: 10px; color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">–í–∏–¥–∂–µ—Ç—ã:</div>';
                    byType.widget.forEach(widget => {
                        html += `
                    <div style="margin: 3px 0; padding: 5px; background: rgba(0,255,136,0.1); border-radius: 3px;">
                        <div style="color:#00ff88; font-weight: bold;">${widget.name}</div>
                        <div style="color:#8899aa; font-size: 0.8em;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${widget.count || 1}</div>
                    </div>
                `;
                    });
                }

                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        function getSavedLoginsDisplay(data) {
            const logins = data.userProfile?.details?.savedLogins;
            if (!logins) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 200px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${logins.hasSavedLogins ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${logins.hasSavedLogins ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ª–æ–≥–∏–Ω—ã
                </span>
                <span style="color:${logins.hasSavedLogins ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${logins.hasSavedLogins ? '–í–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å' : '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã'}
                </span>
            </div>
            <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                –ú–µ—Ç–æ–¥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: ${logins.detectionMethod || 'none'}
            </div>
        </div>
    `;

            if (logins.hasCredentialsAPI) {
                html += `
            <div style="margin-top: 10px; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
                <div style="color:#00ccff; font-weight: bold; margin-bottom: 5px;">Credentials API –¥–æ—Å—Ç—É–ø–µ–Ω</div>
                ${logins.credentialsInfo ? `
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px;">
                        <div style="text-align: center; padding: 4px; background: ${logins.credentialsInfo.passwordCredential ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 3px;">
                            <div style="color:${logins.credentialsInfo.passwordCredential ? '#00ff88' : '#ff5555'}; font-size: 0.8em;">–ü–∞—Ä–æ–ª–∏</div>
                        </div>
                        <div style="text-align: center; padding: 4px; background: ${logins.credentialsInfo.federatedCredential ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 3px;">
                            <div style="color:${logins.credentialsInfo.federatedCredential ? '#00ff88' : '#ff5555'}; font-size: 0.8em;">Federated</div>
                        </div>
                        <div style="text-align: center; padding: 4px; background: ${logins.credentialsInfo.publicKeyCredential ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 3px;">
                            <div style="color:${logins.credentialsInfo.publicKeyCredential ? '#00ff88' : '#ff5555'}; font-size: 0.8em;">WebAuthn</div>
                        </div>
                    </div>
                ` : ''}
            </div>
        `;
            }

            html += '</div>';
            return html;
        }

        function getOAuthRedirectsDisplay(data) {
            const oauth = data.userProfile?.details?.oauthRedirects;
            if (!oauth) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${oauth.detected ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${oauth.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    OAuth —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
                </span>
                <span style="color:${oauth.detected ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${oauth.detected ? `${oauth.count} –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤` : '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã'}
                </span>
            </div>
        </div>
    `;

            if (oauth.oauthReferrer) {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
                <div style="color:#00ccff; font-weight: bold;">OAuth Referrer</div>
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">${oauth.oauthReferrer.domain}</div>
                <div style="color:#8899aa; font-size: 0.8em; word-break: break-all;">${oauth.oauthReferrer.url}</div>
            </div>
        `;
            }

            if (oauth.params && oauth.params.length > 0) {
                html += '<div style="margin-top: 10px;">';
                html += '<div style="color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">OAuth –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:</div>';

                oauth.params.forEach(param => {
                    html += `
                <div style="margin: 5px 0; padding: 6px; background: rgba(255,100,0,0.1); border-radius: 3px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color:#ff9966; font-weight: bold;">${param.param}</span>
                        <span style="color:#8899aa; font-size: 0.8em;">${param.location}</span>
                    </div>
                    <div style="color:#cccccc; font-size: 0.8em; word-break: break-all; margin-top: 3px;">
                        ${param.value}
                    </div>
                </div>
            `;
                });

                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        function getAutofillDisplay(data) {
            const autofill = data.userProfile?.details?.autofillData;
            if (!autofill) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 800px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${autofill.hasForms ? 'rgba(0,100,255,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:#00ccff; font-weight: bold;">–§–æ—Ä–º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</span>
                <span style="color:#00ccff; font-weight: bold;">
                    ${autofill.hasForms ? autofill.formCount : '–ù–µ—Ç —Ñ–æ—Ä–º'}
                </span>
            </div>
            ${autofill.hasForms ? `
                <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                    –ü–æ–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è: ${autofill.autofillFieldCount}
                </div>
            ` : ''}
        </div>
    `;

            if (autofill.autofillFields && autofill.autofillFields.length > 0) {
                html += '<div style="margin-bottom: 10px;">';
                html += '<div style="color:#cccccc; font-size: 0.9em; margin-bottom: 5px;">–ü–æ–ª—è –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:</div>';

                const fieldTypes = {};
                autofill.autofillFields.forEach(field => {
                    const type = field.type || 'text';
                    if (!fieldTypes[type]) fieldTypes[type] = [];
                    fieldTypes[type].push(field);
                });

                Object.entries(fieldTypes).forEach(([type, fields]) => {
                    html += `
                <div style="margin: 5px 0; padding: 6px; background: rgba(0,255,136,0.1); border-radius: 3px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color:#00ff88; font-weight: bold;">${type}</span>
                        <span style="color:#00ff88; font-size: 0.8em;">${fields.length} –ø–æ–ª–µ–π</span>
                    </div>
                    <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                        –ü—Ä–∏–º–µ—Ä—ã: ${fields.slice(0, 3).map(f => f.name || 'unnamed').join(', ')}
                        ${fields.length > 3 ? ` –∏ –µ—â–µ ${fields.length - 3}` : ''}
                    </div>
                </div>
            `;
                });

                html += '</div>';
            }

            if (autofill.hasPaymentRequest) {
                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(255,200,0,0.1); border-radius: 4px; border-left: 3px solid #ffc800;">
                <div style="color:#ffc800; font-weight: bold;">Payment Request API</div>
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">
                    –î–æ—Å—Ç—É–ø–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                </div>
                ${autofill.supportedPaymentMethods && autofill.supportedPaymentMethods.length > 0 ? `
                    <div style="color:#8899aa; font-size: 0.8em; margin-top: 5px;">
                        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã: ${autofill.supportedPaymentMethods.join(', ')}
                    </div>
                ` : ''}
            </div>
        `;
            }

            html += `
        <div style="padding: 8px; background: ${autofill.likelyAutofillUsage ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${autofill.likelyAutofillUsage ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
                </span>
                <span style="color:${autofill.likelyAutofillUsage ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${autofill.likelyAutofillUsage ? '–í—ã—Å–æ–∫–∞—è' : '–ù–∏–∑–∫–∞—è'}
                </span>
            </div>
        </div>
    `;

            html += '</div>';
            return html;
        }

        function getSocialMediaPresenceDisplay(data) {
            const social = data.userProfile?.details?.socialMediaPresence;
            if (!social) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 250px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: ${social.count > 0 ? 'rgba(255,100,0,0.1)' : 'rgba(0,255,136,0.1)'}; border-radius: 4px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${social.count > 0 ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö
                </span>
                <span style="color:${social.count > 0 ? '#ff9966' : '#00ff88'}; font-weight: bold;">
                    ${social.count > 0 ? `${social.count} –ø—Ä–∏–∑–Ω–∞–∫–æ–≤` : '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ'}
                </span>
            </div>
            ${social.detectedServices && social.detectedServices.length > 0 ? `
                <div style="color:#cccccc; font-size: 0.9em; margin-top: 3px;">
                    –°–µ—Ä–≤–∏—Å—ã: ${social.detectedServices.join(', ')}
                </div>
            ` : ''}
        </div>
    `;

            if (social.indicators && social.indicators.length > 0) {
                html += '<div style="margin-top: 10px;">';

                const byType = {};
                social.indicators.forEach(indicator => {
                    if (!byType[indicator.type]) byType[indicator.type] = [];
                    byType[indicator.type].push(indicator);
                });

                Object.entries(byType).forEach(([type, indicators]) => {
                    const typeName =
                        type === 'cookie' ? 'Cookies' :
                            type === 'localStorage' ? 'LocalStorage' :
                                type === 'user-agent' ? 'User Agent' : type;

                    html += `<div style="color:#cccccc; font-size: 0.9em; margin: 10px 0 5px 0;">${typeName}:</div>`;

                    indicators.forEach(indicator => {
                        const confidenceColor =
                            indicator.confidence === 'high' ? '#ff5555' :
                                indicator.confidence === 'medium' ? '#ff9966' : '#ffcc00';

                        html += `
                    <div style="margin: 3px 0; padding: 5px; background: rgba(255,100,0,0.1); border-radius: 3px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color:${confidenceColor}; font-weight: bold;">${indicator.service}</span>
                            <span style="color:${confidenceColor}; font-size: 0.8em;">${indicator.confidence}</span>
                        </div>
                        <div style="color:#8899aa; font-size: 0.8em;">${indicator.details}</div>
                    </div>
                `;
                    });
                });

                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        function getBrowserHabitsDisplay(data) {
            const habits = data.userProfile?.details?.browserHabits;
            if (!habits) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 800px; overflow-y: auto;">';

            const timeOnPage = habits.timeOnPage;
            const timeSeconds = Math.round(timeOnPage / 1000);
            const timeMinutes = Math.round(timeSeconds / 60);

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
            <div style="color:#00ccff; font-weight: bold;">–í—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</div>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 8px;">
                <div style="text-align: center; padding: 6px; background: rgba(0,0,0,0.2); border-radius: 3px;">
                    <div style="color:#00ccff; font-weight: bold; font-size: 1.2em;">${timeMinutes}</div>
                    <div style="color:#8899aa; font-size: 0.7em;">–º–∏–Ω—É—Ç</div>
                </div>
                <div style="text-align: center; padding: 6px; background: rgba(0,0,0,0.2); border-radius: 3px;">
                    <div style="color:#00ccff; font-weight: bold; font-size: 1.2em;">${timeSeconds % 60}</div>
                    <div style="color:#8899aa; font-size: 0.7em;">—Å–µ–∫—É–Ω–¥</div>
                </div>
                <div style="text-align: center; padding: 6px; background: rgba(0,0,0,0.2); border-radius: 3px;">
                    <div style="color:#00ccff; font-weight: bold; font-size: 1.2em;">${Math.round(timeOnPage)}</div>
                    <div style="color:#8899aa; font-size: 0.7em;">–º—Å</div>
                </div>
            </div>
        </div>
    `;

            const scroll = habits.scrollDepth;
            if (scroll && scroll.percentage !== '0%') {
                const scrollColor =
                    scroll.category === 'full' ? '#00ff88' :
                        scroll.category === 'high' ? '#00ccff' :
                            scroll.category === 'medium' ? '#ffcc00' : '#ff9966';

                html += `
            <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
                <div style="color:#00ccff; font-weight: bold;">–ì–ª—É–±–∏–Ω–∞ —Å–∫—Ä–æ–ª–ª–∞</div>
                <div style="margin-top: 8px;">
                    <div style="width: 100%; height: 10px; background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden;">
                        <div style="width: ${scroll.percentage}; height: 100%; background: ${scrollColor}; border-radius: 5px;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                        <span style="color:${scrollColor}; font-weight: bold;">${scroll.percentage}</span>
                        <span style="color:#8899aa; font-size: 0.8em;">${scroll.category}</span>
                    </div>
                    <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                        ${scroll.pixels} –∏–∑ ${scroll.maxScroll}
                    </div>
                </div>
            </div>
        `;
            }

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 4px;">
            <div style="color:#cccccc; font-weight: bold;">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 8px;">
                <div style="text-align: center; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 3px;">
                    <div style="color:#00ccff; font-weight: bold;">–ú—ã—à—å</div>
                    <div style="color:#8899aa; font-size: 0.8em;">
                        ${habits.mouseActivity?.trackingAvailable ? '–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è' : '–ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è'}
                    </div>
                </div>
                <div style="text-align: center; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 3px;">
                    <div style="color:#00ccff; font-weight: bold;">–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞</div>
                    <div style="color:#8899aa; font-size: 0.8em;">
                        ${habits.keyboardActivity?.trackingAvailable ? '–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è' : '–ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è'}
                    </div>
                </div>
            </div>
        </div>
    `;

            const visibility = habits.visibilityChanges;
            if (visibility) {
                html += `
            <div style="padding: 8px; background: rgba(0,255,136,0.1); border-radius: 4px;">
                <div style="color:#00ff88; font-weight: bold;">–í–∏–¥–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã</div>
                <div style="display: flex; justify-content: space-between; margin-top: 8px;">
                    <span style="color:#cccccc;">–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:</span>
                    <span style="color:#00ff88; font-weight: bold; text-transform: capitalize;">
                        ${visibility.currentState}
                    </span>
                </div>
                <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">
                    ${visibility.trackingAvailable ? '–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ' : '–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π'}
                </div>
            </div>
        `;
            }

            html += '</div>';
            return html;
        }

        function getDeviceInteractionDisplay(data) {
            const interaction = data.userProfile?.details?.deviceInteraction;
            if (!interaction) return '<span style="color:#8899aa">–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ</span>';

            let html = '<div style="max-height: 600px; overflow-y: auto;">';

            html += `
        <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px;">
            <div style="color:#00ccff; font-weight: bold;">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º</div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 8px;">
    `;

            const features = [
                { key: 'touchCapable', name: '–°–µ–Ω—Å–æ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω', color: '#00ccff' },
                { key: 'pointerEnabled', name: 'Pointer Events', color: '#00ccff' },
                { key: 'deviceMotion', name: '–î–∞—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è', color: '#00ccff' },
                { key: 'deviceOrientation', name: '–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è', color: '#00ccff' },
                { key: 'vibration', name: '–í–∏–±—Ä–∞—Ü–∏—è', color: '#00ccff' },
                { key: 'gestureEnabled', name: '–ñ–µ—Å—Ç—ã', color: '#00ccff' }
            ];

            features.forEach(feature => {
                const isAvailable = interaction[feature.key];
                html += `
            <div style="text-align: center; padding: 8px; background: ${isAvailable ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 3px;">
                <div style="color:${isAvailable ? feature.color : '#ff5555'}; font-size: 0.8em;">${feature.name}</div>
                <div style="color:#8899aa; font-size: 0.7em;">
                    ${isAvailable ? '‚úì –î–æ—Å—Ç—É–ø–Ω–æ' : '‚úó –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ'}
                </div>
            </div>
        `;
            });

            html += `
            </div>
                ${interaction.maxTouchPoints > 0 ? `
                    <div style="margin-top: 8px; color:#cccccc; font-size: 0.9em;">
                        –ú–∞–∫—Å–∏–º—É–º —Ç–æ—á–µ–∫ –∫–∞—Å–∞–Ω–∏—è: ${interaction.maxTouchPoints}
                    </div>
                    ` : ''}
            </div>
            `;

            html += '</div>';
            return html;
        }

        function getPaymentSummaryDisplay(data) {
            const payments = data.payments?.details;
            if (!payments) {
                return '<span style="color:#8899aa">–î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–±—Ä–∞–Ω—ã</span>';
            }

            const summary = payments.summary || {};

            let html = `
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px;">
    `;

            html += `
        <div style="padding: 10px; background:${summary.hasAutofill ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 6px; text-align: center;">
            <div style="color:${summary.hasAutofill ? '#00ff88' : '#ff5555'}; font-size: 1.8em;">${summary.hasAutofill ? '‚úì' : '‚úó'}</div>
            <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ</div>
        </div>
    `;

            html += `
        <div style="padding: 10px; background:${summary.hasPaymentAPI ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 6px; text-align: center;">
            <div style="color:${summary.hasPaymentAPI ? '#00ff88' : '#ff5555'}; font-size: 1.8em;">${summary.hasPaymentAPI ? '‚úì' : '‚úó'}</div>
            <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">–ü–ª–∞—Ç–µ–∂–Ω—ã–π API</div>
        </div>
    `;

            html += `
        <div style="padding: 10px; background:${summary.hasWebAuthn ? 'rgba(0,255,136,0.1)' : 'rgba(255,100,0,0.1)'}; border-radius: 6px; text-align: center;">
            <div style="color:${summary.hasWebAuthn ? '#00ff88' : '#ff5555'}; font-size: 1.8em;">${summary.hasWebAuthn ? '‚úì' : '‚úó'}</div>
            <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">WebAuthn</div>
        </div>
    `;

            const methodCount = summary.supportedMethods || 0;
            html += `
        <div style="padding: 10px; background: rgba(0, 100, 255, 0.1); border-radius: 6px; text-align: center;">
            <div style="color:#00ccff; font-size: 1.8em; font-weight: bold;">${methodCount}</div>
            <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">–ú–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã</div>
        </div>
    `;

            html += `</div>`;

            const statusColor = summary.canMakePayments ? '#00ff88' : '#ff5555';
            const statusText = summary.canMakePayments ? '–ü–ª–∞—Ç–µ–∂–∏ –¥–æ—Å—Ç—É–ø–Ω—ã' : '–ü–ª–∞—Ç–µ–∂–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã';

            html += `
        <div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px; border-left: 3px solid ${statusColor};">
            <div style="color:${statusColor}; font-weight: bold;">${statusText}</div>
            ${summary.hasBiometric ?
                    '<div style="color:#00ff88; font-size: 0.9em; margin-top: 5px;">‚úì –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞</div>' :
                    '<div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">‚úó –ë–∏–æ–º–µ—Ç—Ä–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</div>'
                }
        </div>
    `;

            return html;
        }

        function getAutofillDisplay(data) {
            const autofill = data.payments?.details?.autofill;
            if (!autofill) {
                return '<span style="color:#8899aa">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>';
            }

            let html = `
        <div style="
            margin-top: 10px;
            padding: 15px;
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 8px;
        ">
    `;

            html += `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span style="color:#00ff88; font-weight: bold;">Credential Management API</span>
            <span style="color:${autofill.available ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                ${autofill.available ? '‚óè –î–æ—Å—Ç—É–ø–µ–Ω' : '‚óè –ù–µ –¥–æ—Å—Ç—É–ø–µ–Ω'}
            </span>
        </div>
    `;

            if (autofill.credentialsAPI) {
                const creds = autofill.credentialsAPI;
                html += `
            <div style="margin-bottom: 15px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–§—É–Ω–∫—Ü–∏–∏ API:</div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                    <div style="padding: 8px; background: ${creds.get ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; border-radius: 4px;">
                        <div style="color:${creds.get ? '#00ff88' : '#ff5555'}; font-size: 0.9em;">get()</div>
                    </div>
                    <div style="padding: 8px; background: ${creds.create ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; border-radius: 4px;">
                        <div style="color:${creds.create ? '#00ff88' : '#ff5555'}; font-size: 0.9em;">create()</div>
                    </div>
                    <div style="padding: 8px; background: ${creds.store ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; border-radius: 4px;">
                        <div style="color:${creds.store ? '#00ff88' : '#ff5555'}; font-size: 0.9em;">store()</div>
                    </div>
                    <div style="padding: 8px; background: ${creds.preventSilentAccess ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; border-radius: 4px;">
                        <div style="color:${creds.preventSilentAccess ? '#00ff88' : '#ff5555'}; font-size: 0.9em;">preventSilentAccess()</div>
                    </div>
                </div>
            </div>
        `;
            }

            if (autofill.features) {
                const features = autofill.features;
                html += `
            <div style="margin-bottom: 15px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã:</div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px;">
                    ${[
                        { key: 'hasPasswordManager', label: '–ü–∞—Ä–æ–ª–∏', icon: 'üîê' },
                        { key: 'hasCreditCardAutofill', label: '–ö–∞—Ä—Ç—ã', icon: 'üí≥' },
                        { key: 'hasAddressAutofill', label: '–ê–¥—Ä–µ—Å', icon: 'üè†' },
                        { key: 'hasNameAutofill', label: '–ò–º—è', icon: 'üë§' },
                        { key: 'hasEmailAutofill', label: 'Email', icon: 'üìß' },
                        { key: 'hasPhoneAutofill', label: '–¢–µ–ª–µ—Ñ–æ–Ω', icon: 'üì±' }
                    ].map(item => `
                        <div style="padding: 6px; background: ${features[item.key] ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; 
                                    border-radius: 4px; text-align: center;">
                            <div style="color:${features[item.key] ? '#00ff88' : '#ff5555'}; font-size: 1.2em;">${item.icon}</div>
                            <div style="color:#8899aa; font-size: 0.8em;">${item.label}</div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
            }

            html += `
        <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px;">
            <div style="display: flex; justify-content: space-between;">
                <span style="color:#8899aa;">–ù–∞–π–¥–µ–Ω–æ —Ñ–æ—Ä–º —Å autocomplete:</span>
                <span style="color:#00ff88; font-weight: bold;">${autofill.formsDetected || 0}</span>
            </div>
            ${autofill.autofillHints?.length > 0 ? `
                <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">
                    –ü–æ–¥—Å–∫–∞–∑–∫–∏: ${autofill.autofillHints.join(', ')}
                </div>
            ` : ''}
        </div>
    `;

            html += `</div>`;
            return html;
        }

        function getPaymentSystemsDisplay(data) {
            const payment = data.payments?.details?.payment;
            if (!payment) {
                return '<span style="color:#8899aa">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>';
            }

            let html = `
        <div style="
            margin-top: 10px;
            padding: 15px;
            background: rgba(255, 153, 102, 0.05);
            border: 1px solid rgba(255, 153, 102, 0.2);
            border-radius: 8px;
        ">
    `;

            html += `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span style="color:#ff9966; font-weight: bold;">Payment Request API</span>
            <span style="color:${payment.available ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                ${payment.available ? '‚óè –î–æ—Å—Ç—É–ø–µ–Ω' : '‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'}
            </span>
        </div>
    `;

            html += `
        <div style="padding: 10px; background: ${payment.canMakePayments ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; 
                    border-radius: 6px; margin-bottom: 15px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:${payment.canMakePayments ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                    ${payment.canMakePayments ? '‚úì –ü–ª–∞—Ç–µ–∂–∏ –≤–æ–∑–º–æ–∂–Ω—ã' : '‚úó –ü–ª–∞—Ç–µ–∂–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã'}
                </span>
                <span style="color:#8899aa;">
                    ${payment.supportedMethods?.length || 0} –º–µ—Ç–æ–¥(–æ–≤)
                </span>
            </div>
        </div>
    `;

            if (payment.supportedMethods?.length > 0) {
                html += `
            <div style="margin-bottom: 15px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã:</div>
                <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                    ${payment.supportedMethods.map(method => {
                    const methodIcons = {
                        'https://google.com/pay': { icon: 'G', color: '#4285F4', name: 'Google Pay' },
                        'https://apple.com/apple-pay': { icon: 'A', color: '#000000', name: 'Apple Pay' },
                        'https://paypal.com': { icon: 'P', color: '#003087', name: 'PayPal' },
                        'basic-card': { icon: 'üí≥', color: '#ff9966', name: '–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã' },
                        'https://amazon.com/amazonpay': { icon: 'A', color: '#FF9900', name: 'Amazon Pay' }
                    };

                    const info = methodIcons[method] || { icon: '?', color: '#8899aa', name: method };

                    return `
                            <div style="display: flex; align-items: center; gap: 6px; padding: 6px 10px; 
                                        background: ${info.color}20; border-radius: 20px; border: 1px solid ${info.color}40;">
                                <div style="width: 24px; height: 24px; background: ${info.color}; 
                                            color: white; border-radius: 50%; display: flex; 
                                            align-items: center; justify-content: center; font-weight: bold;">
                                    ${info.icon}
                                </div>
                                <span style="color:#fff; font-size: 0.9em;">${info.name}</span>
                            </div>
                        `;
                }).join('')}
                </div>
            </div>
        `;
            }

            if (payment.supportedNetworks?.length > 0) {
                html += `
            <div style="margin-bottom: 15px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–°–µ—Ç–∏ –∫–∞—Ä—Ç:</div>
                <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                    ${payment.supportedNetworks.map(network => {
                    const networkColors = {
                        'visa': '#1A1F71',
                        'mastercard': '#EB001B',
                        'amex': '#2E77BC',
                        'discover': '#FF6000',
                        'jcb': '#0F4C81',
                        'mir': '#1E5EB5'
                    };

                    return `
                            <div style="padding: 4px 8px; background: ${networkColors[network] || '#666'}20; 
                                        border-radius: 4px; border: 1px solid ${networkColors[network] || '#666'}40;">
                                <span style="color:#fff; font-size: 0.85em; text-transform: uppercase;">${network}</span>
                            </div>
                        `;
                }).join('')}
                </div>
            </div>
        `;
            }

            if (payment.walletDetection) {
                const wallet = payment.walletDetection;
                html += `
            <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏:</div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                    ${[
                        { key: 'googlePay', label: 'Google Pay', color: wallet.googlePay ? '#00ff88' : '#ff5555' },
                        { key: 'applePay', label: 'Apple Pay', color: wallet.applePay ? '#00ff88' : '#ff5555' },
                        { key: 'paypal', label: 'PayPal', color: wallet.paypal ? '#00ff88' : '#ff5555' },
                        { key: 'amazonPay', label: 'Amazon Pay', color: wallet.amazonPay ? '#00ff88' : '#ff5555' }
                    ].map(item => `
                        <div style="padding: 6px; background: rgba(0,0,0,0.3); border-radius: 4px;">
                            <div style="color:${wallet[item.key] ? item.color : '#ff5555'};
                                        font-size: 0.9em; display: flex; align-items: center; gap: 6px;">
                                <span>${wallet[item.key] ? '‚úì' : '‚úó'}</span>
                                <span>${item.label}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
            }

            html += `</div>`;
            return html;
        }

        function getWebAuthnDisplay(data) {
            const webauthn = data.payments?.details?.webauthn;
            if (!webauthn) {
                return '<span style="color:#8899aa">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>';
            }

            let html = `
        <div style="
            margin-top: 10px;
            padding: 15px;
            background: rgba(102, 102, 255, 0.05);
            border: 1px solid rgba(102, 102, 255, 0.2);
            border-radius: 8px;
        ">
    `;

            html += `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span style="color:#6666ff; font-weight: bold;">WebAuthn / –ë–∏–æ–º–µ—Ç—Ä–∏—è</span>
            <span style="color:${webauthn.available ? '#00ff88' : '#ff5555'}; font-weight: bold;">
                ${webauthn.available ? '‚óè –î–æ—Å—Ç—É–ø–Ω–æ' : '‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'}
            </span>
        </div>
    `;

            const securityColors = {
                'high': '#00ff88',
                'medium': '#ffcc00',
                'low': '#ff5555',
                'unknown': '#8899aa'
            };

            html += `
        <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px; margin-bottom: 15px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color:#8899aa;">–£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</span>
                <span style="color:${securityColors[webauthn.securityLevel]}; font-weight: bold; text-transform: uppercase;">
                    ${webauthn.securityLevel}
                </span>
            </div>
        </div>
    `;

            html += `
        <div style="margin-bottom: 15px;">
            <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:</div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                <div style="padding: 10px; background: ${webauthn.hasBiometric ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; 
                            border-radius: 6px; text-align: center;">
                    <div style="color:${webauthn.hasBiometric ? '#00ff88' : '#ff5555'}; font-size: 1.5em;">
                        ${webauthn.hasBiometric ? '‚úì' : '‚úó'}
                    </div>
                    <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">–ë–∏–æ–º–µ—Ç—Ä–∏—è</div>
                    <div style="color:${webauthn.hasBiometric ? '#00ff88' : '#ff5555'}; font-size: 0.8em; font-weight: bold;">
                        ${webauthn.hasBiometric ? '‚óè –î–æ—Å—Ç—É–ø–Ω–∞' : '‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'}
                    </div>
                </div>
                
                <div style="padding: 10px; background: ${webauthn.hasConditionalUI ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; 
                            border-radius: 6px; text-align: center;">
                    <div style="color:${webauthn.hasConditionalUI ? '#00ff88' : '#ff5555'}; font-size: 1.5em;">
                        ${webauthn.hasConditionalUI ? '‚úì' : '‚úó'}
                    </div>
                    <div style="color:#8899aa; font-size: 0.9em; margin-top: 5px;">–£—Å–ª–æ–≤–Ω—ã–π UI</div>
                    <div style="color:${webauthn.hasConditionalUI ? '#00ff88' : '#ff5555'}; font-size: 0.8em; font-weight: bold;">
                        ${webauthn.hasConditionalUI ? '‚óè –î–æ—Å—Ç—É–ø–µ–Ω' : '‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞'}
                    </div>
                </div>
            </div>
        </div>
    `;

            if (webauthn.capabilities) {
                const caps = webauthn.capabilities;
                html += `
            <div style="margin-bottom: 15px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                    ${[
                        { key: 'u2f', label: 'U2F', icon: 'üîë' },
                        { key: 'ctap2', label: 'CTAP2', icon: 'üîÑ' },
                        { key: 'residentKeys', label: 'Resident Keys', icon: 'üè†' },
                        { key: 'userVerification', label: 'User Verify', icon: 'üë§' }
                    ].map(item => `
                        <div style="padding: 8px; background: ${caps[item.key] ? 'rgba(0,255,136,0.1)' : 'rgba(255,85,85,0.1)'}; 
                                    border-radius: 4px; text-align: center;">
                            <div style="color:${caps[item.key] ? '#00ff88' : '#ff5555'}; font-size: 1.2em;">${item.icon}</div>
                            <div style="color:#8899aa; font-size: 0.8em; margin-top: 3px;">${item.label}</div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
            }

            if (webauthn.authenticators) {
                const auth = webauthn.authenticators;
                html += `
            <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 5px;">
                <div style="color:#8899aa; font-size: 0.9em; margin-bottom: 8px;">–¢–∏–ø—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤:</div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                    <div style="padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px; text-align: center;">
                        <div style="color:#8899aa; font-size: 0.8em;">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</div>
                        <div style="color:#0066ff; font-size: 0.8em; font-weight: bold;">${auth.platform}</div>
                    </div>
                    <div style="padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px; text-align: center;">
                        <div style="color:#8899aa; font-size: 0.8em;">–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞</div>
                        <div style="color:#0066ff; font-size: 0.8em; font-weight: bold;">${auth.crossPlatform}</div>
                    </div>
                    <div style="padding: 8px; background: rgba(0,100,255,0.1); border-radius: 4px; text-align: center;">
                        <div style="color:#8899aa; font-size: 0.8em;">Security Key</div>
                        <div style="color:#0066ff; font-size: 0.8em; font-weight: bold;">${auth.securityKey}</div>
                    </div>
                </div>
            </div>
        `;
            }

            html += `</div>`;
            return html;
        }

        function getDetailedCookiesDisplay(data) {
            if (!data.storage?.cookies?.available) {
                return '<span style="color:#ff5555">‚óè –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</span>';
            }

            const cookies = data.storage.cookies;
            const count = cookies.count || 0;

            if (count === 0) {
                return '<span style="color:#00ff88">‚óè –î–æ—Å—Ç—É–ø–Ω–æ: </span> 0 –∫—É–∫–∏ (—á–∏—Å—Ç—ã–µ cookies)';
            }

            let html = `<div style="margin-top: 10px;">`;
            html += `<span style="color:#00ff88">‚óè –î–æ—Å—Ç—É–ø–Ω–æ: </span> ${count} –∫—É–∫–∏`;

            html += `<div style="margin: 10px 0; padding: 10px; background: rgba(0,255,136,0.1); border-radius: 5px;">`;
            html += `<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; font-size: 0.9em;">`;

            if (cookies.secureCookies > 0) {
                html += `<div>Secure: ${cookies.secureCookies}</div>`;
            }
            if (cookies.httpOnlyCookies > 0) {
                html += `<div>HTTP-Only: ${cookies.httpOnlyCookies}</div>`;
            }
            if (cookies.sessionCookies > 0) {
                html += `<div>–°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ: ${cookies.sessionCookies}</div>`;
            }

            if (cookies.detailedCookies) {
                const categories = {};
                cookies.detailedCookies.forEach(cookie => {
                    categories[cookie.category] = (categories[cookie.category] || 0) + 1;
                });

                Object.entries(categories).forEach(([cat, num]) => {
                    const colors = {
                        'analytics': '#ff5555',
                        'facebook': '#4267B2',
                        'authentication': '#00ff88',
                        'ecommerce': '#ff9966',
                        'preferences': '#66aaff',
                        'consent': '#aa66ff',
                        'other': '#8899aa'
                    };
                    html += `<div><span style="color:${colors[cat] || '#8899aa'}">‚¨§</span> ${cat}: ${num}</div>`;
                });
            }

            html += `</div></div>`;

            if (cookies.detailedCookies && cookies.detailedCookies.length > 0) {
                html += `<details style="margin-top: 10px;">`;
                html += `<summary style="color:#ff9966; cursor: pointer; font-size: 0.9em;">–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ (${cookies.detailedCookies.length})</summary>`;
                html += `<div style="max-height: 300px; overflow-y: auto; margin-top: 10px;">`;

                cookies.detailedCookies.forEach((cookie, index) => {
                    const colors = {
                        'analytics': 'rgba(255, 85, 85, 0.1)',
                        'facebook': 'rgba(66, 103, 178, 0.1)',
                        'authentication': 'rgba(0, 255, 136, 0.1)',
                        'ecommerce': 'rgba(255, 153, 102, 0.1)',
                        'preferences': 'rgba(102, 170, 255, 0.1)',
                        'consent': 'rgba(170, 102, 255, 0.1)',
                        'other': 'rgba(136, 153, 170, 0.1)'
                    };

                    html += `<div style="margin: 5px 0; padding: 8px; background: ${colors[cookie.category] || 'rgba(136, 153, 170, 0.1)'}; 
                     border-radius: 4px; border-left: 3px solid ${colors[cookie.category]?.replace('0.1', '0.5') || '#8899aa'};">`;

                    html += `<div style="display: flex; justify-content: space-between; align-items: center;">`;
                    html += `<strong style="color:#00ff88">${cookie.name}</strong>`;
                    html += `<span style="font-size: 0.8em; color: #8899aa; background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 10px;">
                     ${cookie.category}</span>`;
                    html += `</div>`;

                    html += `<div style="margin-top: 5px; font-size: 0.85em; color: #cccccc;">
                     ${cookie.value} ${cookie.fullLength > 50 ? `<span style="color:#ff9966;">(${cookie.fullLength} chars)</span>` : ''}</div>`;

                    html += `<div style="margin-top: 5px; font-size: 0.75em; color: #8899aa; display: flex; gap: 10px;">`;
                    if (cookie.secure) html += `<span>Secure</span>`;
                    if (cookie.httpOnly) html += `<span>HTTP-Only</span>`;
                    if (cookie.session) html += `<span>–°–µ—Å—Å–∏—è</span>`;
                    html += `<span>${cookie.domain}</span>`;
                    html += `</div>`;

                    html += `</div>`;
                });

                html += `</div></details>`;
            }

            if (cookies.blockersDetected && cookies.blockersDetected.length > 0) {
                html += `<div style="margin-top: 15px; padding: 10px; background: rgba(255, 85, 85, 0.1); border-radius: 6px; border: 1px solid rgba(255, 85, 85, 0.3);">`;
                html += `<div style="color:#ff5555; font-weight: bold; margin-bottom: 8px;">–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–∏ cookie (${cookies.blockersCount})</div>`;
                html += `<div style="font-size: 0.9em;">`;

                cookies.blockersDetected.forEach(blocker => {
                    html += `<div style="margin: 3px 0; padding: 5px; background: rgba(255, 85, 85, 0.2); border-radius: 4px;">
                     ‚Ä¢ ${blocker.tracker} (${blocker.cookieName}) ‚Äî –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</div>`;
                });

                html += `<div style="margin-top: 8px; color: #ff9966; font-size: 0.85em;">
                 –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ç—Ä–µ–∫–µ—Ä–Ω—ã–µ –∫—É–∫–∏</div>`;
                html += `</div></div>`;
            }

            html += `</div>`;
            return html;
        }

        function getBrowserEngine(data) {
            const browser = data.browser || {};
            const browserName = browser.name || '';
            const browserVersion = browser.version || '';

            const getBrowserColor = (name) => {
                const colors = {
                    'Chrome': '#4285F4',
                    'Firefox': '#FF7139',
                    'Safari': '#1B73E8',
                    'Edge': '#0078D7',
                    'Opera': '#FF1B2D',
                    'Internet Explorer': '#0078D6'
                };
                return colors[name] || '#00ff88';
            };

            let engine = '';
            let engineName = '';

            if (browser.isEdge) {
                engine = browser.isChromium ? 'Chromium' : 'EdgeHTML';
                engineName = 'Edge';
            } else if (browser.isOpera) {
                engine = browser.isChromium ? 'Chromium' : 'Presto';
                engineName = 'Opera';
            } else if (browserName === 'Firefox') {
                engine = 'Gecko';
                engineName = 'Firefox';
            } else if (browserName === 'Safari') {
                engine = 'WebKit';
                engineName = 'Safari';
            } else if (browserName === 'Internet Explorer') {
                engine = 'Trident';
                engineName = 'IE';
            } else if (browser.isChromium) {
                engine = 'Chromium';
                engineName = browserName || 'Chromium-–±—Ä–∞—É–∑–µ—Ä';
            } else {
                engine = browserName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                engineName = browserName || '';
            }

            const browserColor = getBrowserColor(browserName);
            const browserText = browserVersion
                ? `<span style="color:${browserColor}">${browserName} v${browserVersion}</span>`
                : `<span style="color:${browserColor}">${browserName}</span>`;

            const engineText = browserVersion
                ? `(<span style="color:#8899aa">${engine} v${browserVersion}</span>)`
                : `(<span style="color:#8899aa">${engine}</span>)`;

            if (browserName && engine && browserName !== engine) {
                return `${browserText} ${engineText}`;
            } else {
                return browserText;
            }
        }

        function switchTab(tabName, clickedElement) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            tabs.forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName + 'Tab').style.display = 'block';

            if (clickedElement) {
                clickedElement.classList.add('active');
            } else {
                const tabButton = document.querySelector(`.tab[onclick*="${tabName}"]`);
                if (tabButton) {
                    tabButton.classList.add('active');
                }
            }
        }

        function clearAll() {
            jsonInput.value = '';
            results.style.display = 'none';
            fileInput.value = '';
        }

        function exportReport() {
            try {
                const data = JSON.parse(extractJsonFromEmail(jsonInput.value));
                const report = generateReport(data);

                const blob = new Blob([report], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `–æ—Ç—á–µ—Ç-${Date.now()}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ' + error.message);
            }
        }

        function generateReport(data) {
            return `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–û—Ç—á–µ—Ç</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .data-row { display: flex; margin: 5px 0; }
        .label { font-weight: bold; width: 200px; }
        .value { flex: 1; }
    </style>
</head>
<body>
    <h1>üìä –û—Ç—á–µ—Ç</h1>
    <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${new Date().toLocaleString('ru-BY')}</p>
    
    <div class="section">
        <h2>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
        <div class="data-row"><div class="label">–í—Ä–µ–º—è —Å–±–æ—Ä–∞:</div><div class="value">${formatDate(data.meta?.collectedAt)}</div></div>
        <div class="data-row"><div class="label">IP –∞–¥—Ä–µ—Å:</div><div class="value">${data.location?.details?.ipBased?.ip || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}</div></div>
        <div class="data-row"><div class="label">–ë—Ä–∞—É–∑–µ—Ä:</div><div class="value">${data.browser?.name || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}</div></div>
    </div>
    
    <div class="section">
        <h2>üìç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</h2>
        <div class="data-row"><div class="label">–°—Ç—Ä–∞–Ω–∞:</div><div class="value">${data.location?.details?.ipBased?.country_name || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞'}</div></div>
        <div class="data-row"><div class="label">–ì–æ—Ä–æ–¥:</div><div class="value">${data.location?.details?.ipBased?.city || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}</div></div>
        <div class="data-row"><div class="label">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</div><div class="value">${getPreciseLocation(data)}</div></div>
    </div>
    
    <div class="section">
        <h2>üíª –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
        <div class="data-row"><div class="label">–≠–∫—Ä–∞–Ω:</div><div class="value">${data.system?.screen?.width || 0} √ó ${data.system?.screen?.height || 0}</div></div>
        <div class="data-row"><div class="label">–û–°:</div><div class="value">${data.browser?.platform || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞'}</div></div>
    </div>
    
    <div class="section">
        <h2>üìÑ –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>
        <pre>${JSON.stringify(data, null, 2)}</pre>
    </div>
</body>
</html>`;
        }

        let decodeTimeout;
        jsonInput.addEventListener('input', () => {
            clearTimeout(decodeTimeout);
            if (jsonInput.value.includes('"collected_data"')) {
                decodeTimeout = setTimeout(decodeData, 1000);
            }
        });
    </script>
</body>

</html>